<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://zhengbuxuan.github.io/"/>
  <updated>2017-09-03T08:36:38.000Z</updated>
  <id>https://zhengbuxuan.github.io/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>TableView ä¼˜åŒ–ç¬”è®°</title>
    <link href="https://zhengbuxuan.github.io/2017/09/02/TableView%20%E4%BC%98%E5%8C%96%E7%AC%94%E8%AE%B0/"/>
    <id>https://zhengbuxuan.github.io/2017/09/02/TableView ä¼˜åŒ–ç¬”è®°/</id>
    <published>2017-09-02T13:44:13.000Z</published>
    <updated>2017-09-03T08:36:38.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0-å‰è¨€"><a href="#0-å‰è¨€" class="headerlink" title="0. å‰è¨€"></a>0. å‰è¨€</h2><p>TableView çš„ä¼˜åŒ–æ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„é—®é¢˜ï¼Œæ— è®ºæ˜¯è‡ªå·±å¹³å¸¸ä½¿ç”¨ï¼Œè¿˜æ˜¯é¢è¯•ç¬”è¯•çš„æ—¶å€™ï¼Œå®ƒéƒ½ä¼šæ— æ—¶ä¸åˆ»åœ°å‡ºç°ã€‚TableView éœ€è¦ä¼˜åŒ–çš„é—®é¢˜ä¸»è¦æœ‰è¿™å‡ ä¸ªï¼š</p>
<ul>
<li><strong>åˆ—è¡¨å·¨é•¿</strong><br>ä¸€èˆ¬æˆ‘ä»¬çš„ TableView éƒ½ä¼šå±•ç¤ºæ¯”è¾ƒå¤šçš„æ•°æ®ï¼Œå°¤å…¶æ˜¯è¯·æ±‚ç½‘ç»œçš„æ—¶å€™ï¼Œéƒ½æ˜¯å“—å•¦å•¦çš„ä¸€ä¸ªå¤§åˆ—è¡¨ã€‚</li>
<li><strong>å›¾ç‰‡å·¨å¤š</strong><br>å¦‚æœæ˜¯å“—å•¦å•¦çš„å¤§åˆ—è¡¨ï¼Œæ¯ä¸€ä¸ª cell éƒ½å¸¦å›¾ç‰‡çš„è¯ï¼Œå¸§ç‡å’”å’”åœ°å¾€ä¸‹æ‰â€¦</li>
<li><strong>åœ†è§’å·¨å¤š</strong><br>å“—å•¦å•¦çš„å¤§åˆ—è¡¨ï¼ŒåŠ ä¸Šå›¾ç‰‡ï¼Œç„¶åå›¾ç‰‡è¿˜å¾—è¦æ˜¯ä¸ªåœ†å½¢â€¦ å®Œäº†ä»¥åå°±æ˜¯ä¸€å †åœ†è§’çŸ©å½¢çš„ label â€¦</li>
<li><strong>é«˜åº¦å·¨ä¹±</strong><br>ä¸‡ä¸€ä½ çš„ TableView æ¯ä¸€ä¸ª cell çš„é«˜åº¦è¿˜éƒ½ä¸ä¸€æ ·â€¦<br>è¿™ä¸ªç¬”è®°å°±å½“ä½œæ˜¯ä¸€ä¸ªå°æ€»ç»“ï¼ŒæŠŠä¸Šé¢è¿™å‡ ä¸ªé—®é¢˜ç»™å°å°åœ°è§£å†³ä¸€ä¸‹ã€‚ä»Šå¤©å…ˆæŠŠæ€è·¯å†™å‡ºæ¥ï¼ŒæŒ–å¥½å‘å†å¡« Demo å’Œä»£ç â€¦ å°±æ˜¯è¿™ä¹ˆæ‡’â€¦</li>
</ul>
<h2 id="1-åˆ—è¡¨å·¨é•¿"><a href="#1-åˆ—è¡¨å·¨é•¿" class="headerlink" title="1. åˆ—è¡¨å·¨é•¿"></a>1. åˆ—è¡¨å·¨é•¿</h2><p>ä¸ç®¡æ˜¯å‰æ‰‹å®çš„æœç´¢åˆ—è¡¨ï¼Œè¿˜æ˜¯çŸ¥ä¹çš„ä¸»é¡µæµï¼Œéƒ½æ˜¯éœ€è¦å±•ç¤ºéå¸¸é•¿çš„åˆ—è¡¨ã€‚å¦‚æœä¸€ä¸‹å­å…¨éƒ¨åŠ è½½è¿›æ¥ï¼Œå°±ç®—åªæœ‰æ–‡å­—ï¼Œç•Œé¢ä¹Ÿä¼šå¡ä½ã€‚ä¸‡ä¸€ç½‘ç»œç¯å¢ƒå†å·®ä¸€ç‚¹ï¼Œæ•´ä¸ªä½“éªŒå°±çƒ‚åˆ°çˆ†ã€‚æ‰€ä»¥ä¸€èˆ¬åœ¨å¤„ç† TableView çš„æ—¶å€™ï¼Œéƒ½ä¼šå…ˆè€ƒè™‘ <strong>ä¸Šæ‹‰åŠ è½½</strong>ã€‚<br>ä¸Šæ‹‰åŠ è½½æœ‰ä¸¤ç§å®ç°çš„æ€è·¯ï¼Œä¸€ç§æ˜¯ä¸Šæ‹‰åˆ° <strong>åˆ—è¡¨åº•éƒ¨</strong> ç„¶åé€šè¿‡åŠ¨ç”»å‘ŠçŸ¥ç”¨æˆ·æ­£åœ¨åŠ è½½ï¼Œä¸€ç§æ˜¯ä¸Šæ‹‰åˆ° <strong>é è¿‘åˆ—è¡¨åº•éƒ¨çš„æŸä¸€ä¸ªä½ç½®</strong> ç„¶åé¢„åŠ è½½ã€‚ç¬¬ä¸€ç§æ€è·¯æœ¬èº«æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœåˆ—è¡¨çœŸçš„å¾ˆé•¿ï¼Œé‚£ç”¨æˆ·å°±ä¼šçœ‹åˆ°å¾ˆå¤šæ¬¡åŠ è½½åŠ¨ç”»ï¼Œä¼šé€ æˆä¸€ç‚¹ä½“éªŒçš„å‰²è£‚æ„Ÿï¼Œæˆ‘è‡ªå·±ä¸æ˜¯å¾ˆå–œæ¬¢ã€‚ç¬¬äºŒç§æ€è·¯èƒ½å¤Ÿç»™ç”¨æˆ·ä¸€ç§æ¯”è¾ƒé¡ºç•…çš„æ„Ÿè§‰ï¼Œä½†æ˜¯å½“ç”¨æˆ·æ»‘åŠ¨å¤ªå¿«æˆ–è€…ç½‘ç»œä¸æ˜¯å¾ˆå¥½çš„æ—¶å€™ï¼Œæœ‰å¯èƒ½é¢„åŠ è½½è¿˜æ²¡å®Œæˆå°±æ»‘åˆ°åº•äº†â€¦ æ‰€ä»¥è¿™ä¸ªæ—¶å€™æœ€å¥½æ˜¯ä¹ŸåŠ ä¸Šä¸€ä¸ªåŠ è½½åŠ¨ç”»ï¼Œä»¥å…é€ æˆç”¨æˆ·çš„ä½“éªŒå›°æƒ‘ã€‚<br>ä¸‹é¢æ˜¯é‡‡ç”¨ç¬¬äºŒç§æ€è·¯çš„å° Demo ä»¥åŠå¯¹åº”çš„éƒ¨åˆ†ä»£ç </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è·å–æ›´å¤šæ•°æ®</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">getMoreData</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">self</span>.flag = <span class="literal">true</span></div><div class="line"></div><div class="line">    <span class="type">DispatchQueue</span>.global().async &#123;</div><div class="line">        <span class="comment">// å‡è£…è¿™æ˜¯ç½‘ç»œåŠ è½½çš„æ—¶é—´</span></div><div class="line">        sleep(<span class="number">2</span>)</div><div class="line">        <span class="comment">// å‡è£…è¿™æ˜¯åŠ è½½æ¥çš„ 20 ä¸ªæ–°æ•°æ®</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">20</span> &#123;</div><div class="line">            <span class="keyword">self</span>.titleTestData.append(<span class="string">"æ–°åŠ å…¥çš„ç¬¬<span class="subst">\(i)</span>ä¸ªæ ‡é¢˜"</span>)</div><div class="line">            <span class="keyword">self</span>.textTestData.append(<span class="string">"æˆ‘æ˜¯æ–°çš„åªæœ‰æ–‡å­—çš„å•å…ƒæ ¼"</span>)</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// ä¸»çº¿ç¨‹åˆ·ä¸€åˆ·</span></div><div class="line">        <span class="type">DispatchQueue</span>.main.async &#123;</div><div class="line">            <span class="keyword">self</span>.flag = <span class="literal">false</span></div><div class="line">            <span class="keyword">self</span>.tableView.reloadData()</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ç”¨TableView çš„ willDisplayCell æ–¹æ³•åˆ¤æ–­ä»€ä¹ˆæ—¶å€™åŠ è½½æ–°æ•°æ®</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, willDisplay cell: UITableViewCell, forRowAt indexPath: IndexPath)</span></span> &#123;</div><div class="line">    <span class="keyword">if</span> <span class="keyword">self</span>.flag == <span class="literal">true</span> &#123;</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">// å½“ä¸‹æ‹‰åˆ°åªå‰© 10 ä¸ªæ•°æ®æ²¡å±•ç¤ºçš„æ—¶å€™å°±åŠ è½½è¿›æ¥æ–°æ•°æ®</span></div><div class="line">    <span class="keyword">if</span> indexPath.row &gt; (<span class="keyword">self</span>.titleTestData.<span class="built_in">count</span> - <span class="number">10</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.getMoreData()</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// è®¾ç½®æç¤º"åŠ è½½ä¸­"çš„é¡µè„š</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">setTableFooterView</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> footerView = <span class="type">UIView</span>(frame: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: tableView.frame.width, height: <span class="number">72</span>))</div><div class="line">    footerView.backgroundColor = .white</div><div class="line"></div><div class="line">    <span class="keyword">let</span> loadingLabel = <span class="type">UILabel</span>(frame: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: <span class="number">12</span>, height: <span class="number">12</span>))</div><div class="line">    loadingLabel.text = <span class="string">"åŠ è½½ä¸­..."</span></div><div class="line">    loadingLabel.font = <span class="type">UIFont</span>.systemFont(ofSize: <span class="number">12</span>)</div><div class="line">    loadingLabel.textColor = .darkGray</div><div class="line">    loadingLabel.sizeToFit()</div><div class="line">    loadingLabel.center = footerView.center</div><div class="line"></div><div class="line">    footerView.addSubview(loadingLabel)</div><div class="line">    tableView.tableFooterView = footerView</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœåªæ˜¯æƒ³è®©ç”¨æˆ·çŸ¥é“ä¸Šæ‹‰å¯ä»¥åŠ è½½ä½†æ˜¯è‡ªå·±åˆæ‡’å¾—å†™çš„è¯ï¼Œå¯ä»¥ç”¨ <strong>ESPullToRefresh</strong> æ¥å®ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„æ¡†æ¶ã€‚<a href="https://github.com/eggswift/pull-to-refresh" target="_blank" rel="external">ESPullToRefresh çš„ GitHub ä¼ é€é—¨</a></p>
<h2 id="2-å›¾ç‰‡å·¨å¤š"><a href="#2-å›¾ç‰‡å·¨å¤š" class="headerlink" title="2. å›¾ç‰‡å·¨å¤š"></a>2. å›¾ç‰‡å·¨å¤š</h2><p>TableView çš„å›¾ç‰‡æ˜¯ä¸€ä¸ªé€ƒä¸æ‰çš„è¯é¢˜ã€‚å¦‚æœæ¯ä¸€ä¸ª cell éƒ½åŒ…å«äº†ä¸€å¼ å›¾ç‰‡ï¼Œè€Œä¸”æ˜¯å®æ—¶åŠ è½½çš„è¯ï¼ŒTableView çš„æ»‘åŠ¨å¾ˆå¤§å¯èƒ½ä¼šæ‰å¸§ã€‚æ‰€ä»¥èªæ˜çš„äººç±»æƒ³å‡ºäº†ä¸€ä¸ªè§£å†³åŠæ³•â€”â€”å¿½ç•¥åŠ è½½ã€‚å°±æ˜¯è¯´æ»‘åŠ¨çš„æ—¶å€™é‚£äº›æ–°æ¥çš„å›¾ç‰‡æˆ‘å°±ä¸åŠ è½½ï¼Œç­‰åˆ°ä½ åœä½äº†ä¸æ»‘åŠ¨äº†ï¼Œæˆ‘å†åŠ è½½å‡ºæ¥ç»™ä½ çœ‹ã€‚è¿™ä¸ªè§£å†³çš„æ€è·¯å°¤å…¶åœ¨å¿«é€Ÿæ»‘åŠ¨çš„æ—¶å€™éå¸¸å¥½ï¼Œå› ä¸ºå¦‚æœç”¨æˆ·æ˜¯å¿«é€Ÿæ»‘åŠ¨çš„è¯ï¼Œé‚£æ„å‘³ç€ä»–å¾ˆå¤§ç¨‹åº¦ä¸Šå¯¹è¿™äº›æ»‘è¿‡å»çš„å†…å®¹æ˜¯ä¸æ„Ÿå…´è¶£çš„ï¼Œä»–éœ€è¦çš„æ˜¯æ›´ä¸‹é¢çš„å†…å®¹ã€‚<br>ä¸‹é¢æ˜¯ä¸€ä¸ªå·¨é•¿çš„åˆ—è¡¨åŠ ä¸Šå›¾ç‰‡ï¼Œç”¨é¢„åŠ è½½å’Œå›¾ç‰‡å¿½ç•¥åŠ è½½çš„å° Demo ä»¥åŠå¯¹åº”çš„éƒ¨åˆ†ä»£ç ï¼š</p>
<p><strong>demo å’Œä»£ç </strong></p>
<h2 id="3-åœ†è§’å·¨å¤š"><a href="#3-åœ†è§’å·¨å¤š" class="headerlink" title="3. åœ†è§’å·¨å¤š"></a>3. åœ†è§’å·¨å¤š</h2><p>åœ†è§’å¾—åˆ†ä¸¤ç§æƒ…å†µæ¥è¯´ï¼Œä¸€ç§æ˜¯ UIView çš„åœ†è§’ï¼Œä¸€ç§æ˜¯ UIImageView/UILabel çš„åœ†è§’ã€‚ä¸¤ç§åœ†è§’çš„åŒºåˆ«åœ¨äºï¼Œå¦‚æœç”¨æœ€åŸç”Ÿçš„æ–¹å¼ cornerRadius è®¾ç½®åœ†è§’åŠå¾„çš„è¯ï¼ŒUIImageView å’Œ UILabel æ˜¯éœ€è¦ç”¨ maskToBounds() æ–¹æ³•æ¥ç»™å®ƒä»¬ä¸Šé®ç½©çš„ï¼Œä½†æ˜¯ UIView ä¸éœ€è¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ æ˜¯éœ€è¦ç»™ UIView ç”»åœ†è§’é‚£å°±ç›´æ¥è®¾ç½® cornerRadius å¥½äº†ï¼Œè¿™ä¸ªä¸ä¼šé€ æˆä»€ä¹ˆå¡é¡¿ã€‚è€Œé’ˆå¯¹ UIImageView å’Œ UILabelï¼Œèªæ˜çš„äººç±»åˆæƒ³å‡ºäº†ä¸€ä¸ªç‰¹åˆ«ä½œå¼Šçš„åŠæ³•â€”â€”åœ†è§’å›¾ç‰‡ã€‚å°±æ˜¯ç›´æ¥ç”»ä¸€å¼ å¸¦åœ†è§’çš„ä¸­é—´é•‚ç©ºçš„å›¾ç‰‡ç»™ä½ å ä¸Šå»â€¦ ç®€ç›´å°±æ˜¯ä½œå¼Šâ€¦ å¯èƒ½æœ‰äººä¼šè¯´ï¼Œå›ºå®šå¤§å°çš„æ˜¯å¯ä»¥ï¼Œé‚£å¦‚æœæ˜¯é•¿åº¦ä¸åŒçš„ UILabel æ€ä¹ˆåŠå’§ã€‚æ–¹æ³•å°±æ˜¯ï¼Œä½ å°±å·¦å³å„ä¸€å¼ å˜›â€¦ (é€ƒâ€¦)<br>ä¸‹é¢æ˜¯ä¸€ä¸ªå·¨é•¿çš„åˆ—è¡¨åŠ ä¸Šåœ†è§’å›¾ç‰‡å’Œåœ†è§’ Labelï¼Œç”¨é¢„åŠ è½½ã€å›¾ç‰‡å¿½ç•¥åŠ è½½å’Œåœ†è§’ä½œå¼Šæ³•çš„å° Demo ä»¥åŠå¯¹åº”çš„éƒ¨åˆ†ä»£ç ï¼š</p>
<p><strong>demo å’Œä»£ç </strong></p>
<h2 id="4-é«˜åº¦å·¨ä¹±"><a href="#4-é«˜åº¦å·¨ä¹±" class="headerlink" title="4. é«˜åº¦å·¨ä¹±"></a>4. é«˜åº¦å·¨ä¹±</h2><p>åƒæœ‹å‹åœˆè¿™æ ·ï¼Œcell çš„è¡Œé«˜æ˜¯è·Ÿæ¯ä¸ªç”¨æˆ·å‘å¸ƒçš„å†…å®¹æœ‰å…³ç³»ï¼Œæ‰€ä»¥æ¯ä¸ª cell çš„è¡Œé«˜å°±ä¸å¾—ä¸è®¡ç®—ã€‚ä¸å®šè¡Œé«˜ä¹Ÿæ˜¯ TableView ä¼˜åŒ–ä¸èƒ½ä¸è§£å†³çš„é—®é¢˜ã€‚è§£å†³çš„åŠæ³•å°±æ˜¯â€”â€”ç¼“å­˜ã€‚</p>
<h2 id="5-å°ç»“"><a href="#5-å°ç»“" class="headerlink" title="5. å°ç»“"></a>5. å°ç»“</h2><p>TableView æ˜¯ä¸€ä¸ªç‰¹åˆ«å¯æ¨çš„ä¸œè¥¿â€¦ å› ä¸ºæ¯•ç«Ÿå…¨ä¸–ç•Œéƒ½åœ¨ä¸ºå®ƒçš„è¿™äº›ä½¿ç”¨åœºæ™¯åšä¼˜åŒ–ï¼Œéå¸¸æœŸå¾…æ°´æœåœ¨æŸä¸€å¤©èƒ½å¤Ÿç»™å‡ºä¸€ä¸ªå®˜æ–¹çš„è§£å†³æ–¹æ¡ˆæˆ–è€…ç›´æ¥å†™å¥½æ–¹æ³•(æ²¡é”™å°±æ˜¯è¿™ä¹ˆæ‡’)â€¦<br>è¿˜æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„ç‚¹ï¼Œä¸€å®šè¦æ ¹æ®æƒ…å†µæ¥å®šåˆ¶å…·ä½“æ–¹æ¡ˆã€‚<br>å¦‚æœ TableView ä¸é•¿é‚£ä¹ˆåˆ†é¡µåŠ è½½æ¥å¹²ä»€ä¹ˆâ€¦<br>å¦‚æœåœ†è§’ä¸å¤šï¼Œåªæ˜¯æ‰ä¸ªä¸€ä¸¤å¸§é‚£æœ‰ä»€ä¹ˆå¥½ä¼˜åŒ–çš„â€¦<br>ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œä¸€å®šè¦â€¦ æ‡’â€¦ [æ‰‹åŠ¨ç‹—å¤´] [æ‰‹åŠ¨ç‹—å¤´] [æ‰‹åŠ¨ç‹—å¤´]</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;0-å‰è¨€&quot;&gt;&lt;a href=&quot;#0-å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;0. å‰è¨€&quot;&gt;&lt;/a&gt;0. å‰è¨€&lt;/h2&gt;&lt;p&gt;TableView çš„ä¼˜åŒ–æ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„é—®é¢˜ï¼Œæ— è®ºæ˜¯è‡ªå·±å¹³å¸¸ä½¿ç”¨ï¼Œè¿˜æ˜¯é¢è¯•ç¬”è¯•çš„æ—¶å€™ï¼Œå®ƒéƒ½ä¼šæ— æ—¶ä¸åˆ»åœ°å‡ºç°ã€‚Table
    
    </summary>
    
    
      <category term="iOS ä¼˜åŒ–" scheme="https://zhengbuxuan.github.io/tags/iOS-%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>iOS å¤šçº¿ç¨‹ GCD Swift 3</title>
    <link href="https://zhengbuxuan.github.io/2017/08/31/iOS%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B9%8B%20GCD/"/>
    <id>https://zhengbuxuan.github.io/2017/08/31/iOS å¤šçº¿ç¨‹ä¹‹ GCD/</id>
    <published>2017-08-31T15:00:00.000Z</published>
    <updated>2017-09-01T15:20:35.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0-å‰è¨€"><a href="#0-å‰è¨€" class="headerlink" title="0. å‰è¨€"></a>0. å‰è¨€</h1><p>GCD(Grand Central Dispatch)æ˜¯ Apple å¼€å‘çš„ä¸€ç§å¤šæ ¸ç¼–ç¨‹çš„æ–¹æ³•ï¼Œä¸»è¦çš„ä½œç”¨æ˜¯ä¼˜åŒ–åº”ç”¨ç¨‹åºå¯¹å¤šæ ¸å¤„ç†å™¨çš„è¿ç”¨ï¼Œæ˜¯åœ¨çº¿ç¨‹æ± æ¨¡å¼çš„åŸºç¡€ä¸Šæ‰§è¡Œçš„å¹¶è¡Œä»»åŠ¡ã€‚GCDä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„åŸºæœ¬æ¦‚å¿µâ€”-<strong>ä»»åŠ¡</strong> å’Œ <strong>é˜Ÿåˆ—</strong>ã€‚</p>
<hr>
<h1 id="1-ä»»åŠ¡å’Œé˜Ÿåˆ—"><a href="#1-ä»»åŠ¡å’Œé˜Ÿåˆ—" class="headerlink" title="1. ä»»åŠ¡å’Œé˜Ÿåˆ—"></a>1. ä»»åŠ¡å’Œé˜Ÿåˆ—</h1><p><strong>ä»»åŠ¡</strong> å°±æ˜¯æ‰§è¡Œçš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯åœ¨çº¿ç¨‹ä¸­æ‰§è¡Œçš„ä»£ç ï¼Œå°è£…åœ¨ Swift çš„é—­åŒ…(Closure)æˆ–è€… OC çš„å—(block)é‡Œã€‚æ ¹æ®èƒ½å¦å…·å¤‡å¼€å¯æ–°çº¿ç¨‹å¯ä»¥åˆ†æˆ <strong>åŒæ­¥æ‰§è¡Œ</strong> å’Œ <strong>å¼‚æ­¥æ‰§è¡Œ</strong>ã€‚</p>
<ul>
<li><strong>åŒæ­¥æ‰§è¡Œ(sync)</strong> åªèƒ½åœ¨å½“å‰çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ï¼Œä¸èƒ½å¼€æ–°çº¿ç¨‹ï¼Œå½“å‰çš„ä»£ç æ®µæ²¡æœ‰æ‰§è¡Œå®Œå°±ä¸èƒ½å¤Ÿæ‰§è¡Œä¸‹ä¸€éƒ¨åˆ†ï¼Œä¼šé˜»å¡å½“å‰çº¿ç¨‹ã€‚</li>
<li><strong>å¼‚æ­¥æ‰§è¡Œ(async)</strong> å¯ä»¥åœ¨æ–°çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ï¼Œèƒ½å¤Ÿå¼€å¯æ–°çº¿ç¨‹ï¼Œä¸ç”¨ç­‰å¾…å½“å‰çš„ä»£ç æ®µæ‰§è¡Œå®Œå°±å¯ä»¥å¾€ä¸‹æ‰§è¡Œåç»­ä»£ç ï¼Œä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹ã€‚</li>
</ul>
<p><strong>é˜Ÿåˆ—</strong> å°±æ˜¯ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿æ€§è¡¨ï¼Œæ»¡è¶³ FIFO çš„åŸåˆ™ã€‚åœ¨ GCD é‡Œåˆ†ä¸º <strong>ä¸²è¡Œé˜Ÿåˆ—</strong> å’Œ <strong>å¹¶å‘é˜Ÿåˆ—</strong>ã€‚</p>
<ul>
<li>ä¸²è¡Œé˜Ÿåˆ—(Serial Dispatch Queue) ä¸€ä¸ªä»»åŠ¡å®Œæˆåæ¥ç€æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚</li>
<li>å¹¶å‘é˜Ÿåˆ—(Concurrent Dispatch Queue) è‡ªåŠ¨å¼€å¯å¤šä¸ªçº¿ç¨‹è¿›è¡Œå¤šä¸ªä»»åŠ¡å¹¶å‘æ‰§è¡Œï¼Œè€Œä¸”å¹¶å‘åªæœ‰åœ¨å¼‚æ­¥æ‰§è¡Œ(dispatch_async)æƒ…å†µä¸‹æ‰æœ‰æ•ˆã€‚</li>
</ul>
<hr>
<h1 id="2-åˆ›å»ºé˜Ÿåˆ—"><a href="#2-åˆ›å»ºé˜Ÿåˆ—" class="headerlink" title="2. åˆ›å»ºé˜Ÿåˆ—"></a>2. åˆ›å»ºé˜Ÿåˆ—</h1><p><strong>ç³»ç»Ÿé»˜è®¤é˜Ÿåˆ—â€”-ä¸»é˜Ÿåˆ—(ä¸²è¡Œ)</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ä¸»é˜Ÿåˆ—</span></div><div class="line"><span class="keyword">let</span> mainQueue = <span class="type">DispatchQueue</span>.main</div></pre></td></tr></table></figure>
<p><strong>ç³»ç»Ÿé»˜è®¤é˜Ÿåˆ—â€”-å…¨å±€é˜Ÿåˆ—(å¹¶å‘)</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å…¨å±€é˜Ÿåˆ—</span></div><div class="line"><span class="keyword">let</span> globalQueue = <span class="type">DispatchQueue</span>.global()</div></pre></td></tr></table></figure>
<p>å…¨å±€é˜Ÿåˆ—æœ‰ 4 ä¸ªæ‰§è¡Œçš„ä¼˜å…ˆçº§ï¼Œä»é«˜åˆ°ä½åˆ†åˆ«æ˜¯ï¼š <strong>.userInitiated</strong>ï¼Œ<strong>.default</strong>ï¼Œ<strong>.utility</strong>ï¼Œ<strong>.background</strong> æ‰€ä»¥å½“éœ€è¦åˆ›å»ºæŒ‡å®šæŸä¸ªä¼˜å…ˆçº§çš„å…¨å±€é˜Ÿåˆ—æ—¶ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> defaultGlobalQueue = <span class="type">DispatchQueue</span>.global(qos: .<span class="keyword">default</span>)</div></pre></td></tr></table></figure>
<p><strong>è‡ªå®šä¹‰åˆ›å»ºé˜Ÿåˆ—</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åˆ›å»ºä¸²è¡Œé˜Ÿåˆ—</span></div><div class="line"><span class="keyword">let</span> serialQueue = <span class="type">DispatchQueue</span>(label: <span class="string">"serialQueue_1"</span>)</div><div class="line"><span class="comment">//åˆ›å»ºä¼˜å…ˆçº§ä¸ºdefaultçš„ä¸²è¡Œé˜Ÿåˆ—</span></div><div class="line"><span class="keyword">let</span> serialQueue = <span class="type">DispatchQueue</span>(label: <span class="string">"serialQueue_2"</span>, qos: .<span class="keyword">default</span>)</div><div class="line"></div><div class="line"><span class="comment">//åˆ›å»ºä¼˜å…ˆçº§ä¸ºbackgroundçš„å¹¶å‘é˜Ÿåˆ—</span></div><div class="line"><span class="keyword">let</span> concurrentQueue = <span class="type">DispatchQueue</span>(label: <span class="string">"concurrentQueue"</span>, qos: .background, attributes: .concurrent)</div></pre></td></tr></table></figure>
<hr>
<h1 id="é˜Ÿåˆ—æ‰§è¡Œ"><a href="#é˜Ÿåˆ—æ‰§è¡Œ" class="headerlink" title="é˜Ÿåˆ—æ‰§è¡Œ"></a>é˜Ÿåˆ—æ‰§è¡Œ</h1><p>é˜Ÿåˆ—çš„æ‰§è¡Œéƒ¨åˆ†å¯ä»¥ç”¨ 3 ä¸ªä»»åŠ¡æ¥åæ˜ å‡ºä»»åŠ¡æ‰§è¡Œçš„é¡ºåºã€‚ <strong>åŒæ­¥å¹¶è¡Œ</strong> ä»£ç ç¤ºä¾‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">syncConcurrent</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> queue = <span class="type">DispatchQueue</span>(label: <span class="string">"queue"</span>, attributes: .concurrent)</div><div class="line"></div><div class="line">    <span class="built_in">print</span>(<span class="string">"--- begin ---"</span>)</div><div class="line"></div><div class="line">    queue.sync &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">3</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"--- ğŸ…°ï¸ <span class="subst">\(i)</span> ---<span class="subst">\(Thread.current)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    queue.sync &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">3</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"--- ğŸ…±ï¸ <span class="subst">\(i)</span> ---<span class="subst">\(Thread.current)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    queue.sync &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">3</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"--- ğŸ…¾ï¸ <span class="subst">\(i)</span> ---<span class="subst">\(Thread.current)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">print</span>(<span class="string">"--- end ---"</span>)</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰“å°ç»“æœ</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">--- begin ---</div><div class="line">--- ğŸ…°ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400006f380</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…°ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400006f380</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…°ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400006f380</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…±ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400006f380</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…±ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400006f380</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…±ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400006f380</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…¾ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400006f380</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…¾ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400006f380</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…¾ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400006f380</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- end ---</div></pre></td></tr></table></figure>
<blockquote>
<p>ä»»åŠ¡æ˜¯æŒ‰ç…§é¡ºåºé€ä¸ªæ‰§è¡Œçš„ï¼Œå¹¶ä¸”åªæœ‰ä¸€ä¸ªä¸»çº¿ç¨‹åœ¨æˆ˜æ–—</p>
</blockquote>
<p><strong>å¼‚æ­¥å¹¶è¡Œ</strong> ä»£ç ç¤ºä¾‹</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">asyncConcurrent</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> queue = <span class="type">DispatchQueue</span>(label: <span class="string">"queue"</span>, attributes: .concurrent)</div><div class="line"></div><div class="line">    <span class="built_in">print</span>(<span class="string">"--- begin ---"</span>)</div><div class="line"></div><div class="line">    queue.async &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">3</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"--- ğŸ…°ï¸ <span class="subst">\(i)</span> ---<span class="subst">\(Thread.current)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    queue.async &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">3</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"--- ğŸ…±ï¸ <span class="subst">\(i)</span> ---<span class="subst">\(Thread.current)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    queue.async &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">3</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"--- ğŸ…¾ï¸ <span class="subst">\(i)</span> ---<span class="subst">\(Thread.current)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">print</span>(<span class="string">"--- end ---"</span>)</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰“å°ç»“æœ 1</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">--- begin ---</div><div class="line">--- ğŸ…°ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x604000078bc0</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div><div class="line">--- ğŸ…±ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6080000747c0</span>&gt;&#123;number = <span class="number">4</span>, name = (null)&#125;</div><div class="line">--- ğŸ…°ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x604000078bc0</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div><div class="line">--- ğŸ…¾ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6040000793c0</span>&gt;&#123;number = <span class="number">5</span>, name = (null)&#125;</div><div class="line">--- ğŸ…±ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6080000747c0</span>&gt;&#123;number = <span class="number">4</span>, name = (null)&#125;</div><div class="line">--- ğŸ…°ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x604000078bc0</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div><div class="line">--- end ---</div><div class="line">--- ğŸ…¾ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6040000793c0</span>&gt;&#123;number = <span class="number">5</span>, name = (null)&#125;</div><div class="line">--- ğŸ…±ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6080000747c0</span>&gt;&#123;number = <span class="number">4</span>, name = (null)&#125;</div><div class="line">--- ğŸ…¾ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6040000793c0</span>&gt;&#123;number = <span class="number">5</span>, name = (null)&#125;</div></pre></td></tr></table></figure>
<p>æ‰“å°ç»“æœ 2</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">--- begin ---</div><div class="line">--- ğŸ…°ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x604000069140</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div><div class="line">--- ğŸ…±ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60800006aa40</span>&gt;&#123;number = <span class="number">4</span>, name = (null)&#125;</div><div class="line">--- ğŸ…°ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x604000069140</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div><div class="line">--- ğŸ…±ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60800006aa40</span>&gt;&#123;number = <span class="number">4</span>, name = (null)&#125;</div><div class="line">--- ğŸ…¾ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60800006a900</span>&gt;&#123;number = <span class="number">5</span>, name = (null)&#125;</div><div class="line">--- ğŸ…°ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x604000069140</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div><div class="line">--- end ---</div><div class="line">--- ğŸ…¾ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60800006a900</span>&gt;&#123;number = <span class="number">5</span>, name = (null)&#125;</div><div class="line">--- ğŸ…±ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60800006aa40</span>&gt;&#123;number = <span class="number">4</span>, name = (null)&#125;</div><div class="line">--- ğŸ…¾ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60800006a900</span>&gt;&#123;number = <span class="number">5</span>, name = (null)&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>æ¯ä¸€æ¬¡è¿è¡Œçš„æ‰§è¡Œé¡ºåºä¸ä¸€å®šç›¸åŒï¼Œä»»åŠ¡çš„æ‰§è¡Œæ˜¯äº¤æ›¿çš„ï¼Œä¸€å…±æ–°å¼€äº† 3 ä¸ªçº¿ç¨‹åœ¨æˆ˜æ–—ã€‚å¹¶ä¸”ä» begin å’Œ end çš„ä½ç½®å¯ä»¥çœ‹å‡ºï¼Œ3 ä¸ªä»»åŠ¡è¢«æ·»åŠ åˆ°é˜Ÿåˆ—ä¹‹åå°±ç«‹åˆ»å¼€å§‹äº†æˆ˜æ–—ã€‚</p>
</blockquote>
<p><strong>åŒæ­¥ä¸²è¡Œ</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">syncSerial</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> queue = <span class="type">DispatchQueue</span>(label: <span class="string">"queue"</span>)</div><div class="line"></div><div class="line">    <span class="built_in">print</span>(<span class="string">"--- begin ---"</span>)</div><div class="line"></div><div class="line">    queue.sync &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">3</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"--- ğŸ…°ï¸ <span class="subst">\(i)</span> ---<span class="subst">\(Thread.current)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    queue.sync &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">3</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"--- ğŸ…±ï¸ <span class="subst">\(i)</span> ---<span class="subst">\(Thread.current)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    queue.sync &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">3</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"--- ğŸ…¾ï¸ <span class="subst">\(i)</span> ---<span class="subst">\(Thread.current)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">print</span>(<span class="string">"--- end ---"</span>)</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰“å°ç»“æœ</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">--- begin ---</div><div class="line">--- ğŸ…°ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6000000777c0</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…°ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6000000777c0</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…°ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6000000777c0</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…±ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6000000777c0</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…±ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6000000777c0</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…±ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6000000777c0</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…¾ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6000000777c0</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…¾ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6000000777c0</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- ğŸ…¾ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x6000000777c0</span>&gt;&#123;number = <span class="number">1</span>, name = main&#125;</div><div class="line">--- end ---</div></pre></td></tr></table></figure>
<blockquote>
<p>æ‰“å°ç»“æœå’ŒåŒæ­¥å¹¶è¡Œä¸€ä¸ªæ ·ï¼Œéƒ½æ˜¯åªæœ‰ä¸»çº¿ç¨‹åœ¨æˆ˜æ–—ï¼Œå¹¶ä¸”æŒ‰ç…§é¡ºåºé€ä¸€æ‰§è¡Œã€‚</p>
</blockquote>
<p><strong>ä¸²è¡Œå¼‚æ­¥</strong> ä»£ç ç¤ºä¾‹</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">asyncSerial</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> queue = <span class="type">DispatchQueue</span>(label: <span class="string">"queue"</span>)</div><div class="line"></div><div class="line">    <span class="built_in">print</span>(<span class="string">"--- begin ---"</span>)</div><div class="line"></div><div class="line">    queue.async &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">3</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"--- ğŸ…°ï¸ <span class="subst">\(i)</span> ---<span class="subst">\(Thread.current)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    queue.async &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">3</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"--- ğŸ…±ï¸ <span class="subst">\(i)</span> ---<span class="subst">\(Thread.current)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    queue.async &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">3</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"--- ğŸ…¾ï¸ <span class="subst">\(i)</span> ---<span class="subst">\(Thread.current)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">print</span>(<span class="string">"--- end ---"</span>)</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰“å°ç»“æœ</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">--- begin ---</div><div class="line">--- ğŸ…°ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400007a700</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div><div class="line">--- ğŸ…°ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400007a700</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div><div class="line">--- ğŸ…°ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400007a700</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div><div class="line">--- end ---</div><div class="line">--- ğŸ…±ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400007a700</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div><div class="line">--- ğŸ…±ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400007a700</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div><div class="line">--- ğŸ…±ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400007a700</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div><div class="line">--- ğŸ…¾ï¸ <span class="number">1</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400007a700</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div><div class="line">--- ğŸ…¾ï¸ <span class="number">2</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400007a700</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div><div class="line">--- ğŸ…¾ï¸ <span class="number">3</span> ---&lt;<span class="type">NSThread</span>: <span class="number">0x60400007a700</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>ä»»åŠ¡æ˜¯æŒ‰é¡ºåºé€ä¸€è¿›è¡Œçš„ï¼Œå¼€å¯äº†ä¸€æ¡æ–°çš„çº¿ç¨‹ã€‚</p>
</blockquote>
<p><strong>ä¸»é˜Ÿåˆ—å’Œå…¨å±€é˜Ÿåˆ—çš„åŒæ­¥/å¼‚æ­¥</strong> åŒæ­¥</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="type">DispatchQueue</span>.global(qos: .<span class="keyword">default</span>).async &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"I'm in global."</span>)</div><div class="line">    <span class="type">DispatchQueue</span>.main.async &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"I'm back in main."</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¼‚æ­¥</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Global Dispatch Queue</span></div><div class="line"><span class="comment">//ä¸ä¼šæ­»é”ï¼Œä½†ä»£ç é¡ºåºæ‰§è¡Œï¼Œåç»­ä»£ç éœ€è¦ç­‰å¾…å‰é¢ä»£ç æ‰§è¡Œå®Œæ¯•</span></div><div class="line"><span class="type">DispatchQueue</span>.global(qos: .<span class="keyword">default</span>).sync &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"I'm in global."</span>)</div><div class="line">    <span class="built_in">print</span>(<span class="string">"I'm still in global."</span>)</div><div class="line">&#125;</div><div class="line"><span class="built_in">print</span>(<span class="string">"I'm out."</span>)</div><div class="line"></div><div class="line"><span class="comment">//Main Queue</span></div><div class="line"><span class="comment">//æ­»é”ã€‚æŒ‰ç…§åŒæ­¥çš„æ‰§è¡Œé¡ºåºï¼Œä¸€ä¸ªä»»åŠ¡éœ€è¦ç­‰å¾…å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œä½†æ˜¯"I'm in main."æ˜¯æ·»åŠ åœ¨"I'm out."ä¹‹åï¼Œä½†æ˜¯"I'm out"åˆéœ€è¦ç­‰å¾…"I'm in main."æ‰§è¡Œå®Œæ¯•ä¹‹åå†æ‰§è¡Œã€‚æ‰€ä»¥å½¼æ­¤ç­‰å¾…é€ æˆäº†æ­»é”ã€‚</span></div><div class="line"><span class="type">DispatchQueue</span>.main.sync &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"I'm in main."</span>)</div><div class="line">&#125;</div><div class="line"><span class="built_in">print</span>(<span class="string">"I'm out."</span>)</div></pre></td></tr></table></figure>
<p><strong>é˜Ÿåˆ—æš‚åœå’Œç»§ç»­</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æš‚åœ</span></div><div class="line">queue.suspend()</div><div class="line"><span class="comment">//ç»§ç»­</span></div><div class="line">queue.resume()</div></pre></td></tr></table></figure>
<p>suspend() å’Œ resume() æ˜¯å¼‚æ­¥å‡½æ•°ï¼Œåœ¨ä¸¤ä¸ªé—­åŒ…ä¹‹é—´ç”Ÿæ•ˆã€‚ suspend() ä¼šä½¿å¾—å·²ç»æ·»åŠ åˆ° Dispatch Queue ä½†æ˜¯è¿˜æ²¡æœ‰æ‰§è¡Œçš„ä»»åŠ¡åœ¨æ”¹è¡Œä»£ç ä¹‹åæš‚åœæ‰§è¡Œï¼Œç­‰åˆ° resume() ä¹‹åæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚</p>
<p><strong>å•æ¬¡æ‰§è¡Œ</strong> å•æ¬¡æ‰§è¡Œåœ¨å¤šçº¿ç¨‹ç¼–ç¨‹çš„ä½¿ç”¨è¿‡ç¨‹ä¸­å¾ˆå¸¸è§ï¼Œå½“ç„¶é™¤äº†å¤šçº¿ç¨‹ä¹‹å¤–ä¹Ÿæœ‰ä¸€äº›å…¶ä»–çš„ç”¨é€”ã€‚ åœ¨ Swift 3 ä¹‹å‰ï¼Œå•æ¬¡æ‰§è¡Œå¯ä»¥é€šè¿‡ dispatch_once æ¥å®ç°ï¼Œä½†æ˜¯ Swift 3 æŠŠå®ƒåºŸå¼ƒäº†â€¦ æŸ¥äº†ä¸€äº›èµ„æ–™å‘ç°è¦å®ç°åŸæ¥çš„ dispatch_once å¯ä»¥é€šè¿‡ä¸‹é¢å‡ ä¸ªæ–¹å¼ï¼š</p>
<ul>
<li><p>å…¨å±€å¸¸é‡</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> constant = <span class="type">SomeClass</span>()</div></pre></td></tr></table></figure>
</li>
<li><p>å…¨å±€å˜é‡(å¸¦æœ‰ç«‹å³æ‰§è¡Œçš„é—­åŒ…æ„é€ å™¨)</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> variable: <span class="type">SomeClass</span> = &#123;</div><div class="line"> <span class="keyword">let</span> constant = <span class="type">SomeClass</span>()</div><div class="line"> constant.oneProperty = <span class="string">"HeySiri"</span></div><div class="line"> constant.oneMethod()</div><div class="line"> <span class="keyword">return</span> constant</div><div class="line">&#125;()</div></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h1 id="3-æœªå®Œå¾…ç»­â€¦"><a href="#3-æœªå®Œå¾…ç»­â€¦" class="headerlink" title="3. æœªå®Œå¾…ç»­â€¦"></a>3. æœªå®Œå¾…ç»­â€¦</h1>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0-å‰è¨€&quot;&gt;&lt;a href=&quot;#0-å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;0. å‰è¨€&quot;&gt;&lt;/a&gt;0. å‰è¨€&lt;/h1&gt;&lt;p&gt;GCD(Grand Central Dispatch)æ˜¯ Apple å¼€å‘çš„ä¸€ç§å¤šæ ¸ç¼–ç¨‹çš„æ–¹æ³•ï¼Œä¸»è¦çš„ä½œç”¨æ˜¯ä¼˜åŒ–åº”ç”¨ç¨‹åº
    
    </summary>
    
    
      <category term="iOS å¤šçº¿ç¨‹" scheme="https://zhengbuxuan.github.io/tags/iOS-%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>iOS å¤šçº¿ç¨‹ä¹‹ åŸºç¡€</title>
    <link href="https://zhengbuxuan.github.io/2017/08/29/iOS%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B9%8B%20%E5%9F%BA%E7%A1%80/"/>
    <id>https://zhengbuxuan.github.io/2017/08/29/iOS å¤šçº¿ç¨‹ä¹‹ åŸºç¡€/</id>
    <published>2017-08-29T12:00:00.000Z</published>
    <updated>2017-08-29T15:00:39.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><hr>
<p>å…³äºå¤šçº¿ç¨‹éœ€è¦ç†è§£çš„ä¸€äº›åŸºæœ¬çš„æ¦‚å¿µï¼Œä¸ºäº†é˜²æ­¢æ‰“ä»£ç æ‰“åˆ°é˜¿å°”å…¹æµ·é»˜ç—‡ï¼Œå†™ä¸‹å‡ ä¸ªæŠ–æœºçµçš„ ğŸŒ° â€¦</p>
<p><br></p>
<h2 id="è¿›ç¨‹å’Œçº¿ç¨‹"><a href="#è¿›ç¨‹å’Œçº¿ç¨‹" class="headerlink" title="è¿›ç¨‹å’Œçº¿ç¨‹"></a>è¿›ç¨‹å’Œçº¿ç¨‹</h2><hr>
<p><strong><code>1</code> è¿›ç¨‹æ˜¯ä»€ä¹ˆ</strong></p>
<p>è¿›ç¨‹å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çš„ç¨‹åºï¼Œå„ä¸ªè¿›ç¨‹ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚</p>
<p><strong><code>2</code> çº¿ç¨‹æ˜¯ä»€ä¹ˆ</strong></p>
<p>çº¿ç¨‹æ˜¯è¿›ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­çš„æ‰§è¡Œè·¯å¾„ã€‚æ¯ä¸€ä¸ªè¿›ç¨‹æƒ³è¦è¿è¡Œï¼Œéƒ½éœ€è¦è‡³å°‘ä¸€ä¸ªçº¿ç¨‹æ¥ç¡®å®šä»£ç çš„æ‰§è¡Œè·¯å¾„ã€‚</p>
<p><strong><code>3</code> ç„¶åå‘¢â€¦</strong></p>
<p>ä¸¾ä¸ªæ —å­ï¼Œæ‰‹æœºé‡Œçš„å¾®ä¿¡å’ŒQQåœ¨è¿è¡Œçš„æ—¶å€™ï¼Œéƒ½æ˜¯ iOS ç³»ç»Ÿä¸­çš„è¿›ç¨‹ã€‚å½“ä½ æ‰“å¼€å¾®ä¿¡ï¼Œç»™ä½ çš„å¥½åŸºå‹å‘äº†ä¸€æ¡ 60 ç§’çš„è¯­éŸ³ä¿¡æ¯ï¼Œåœ¨ä½ æ¾å¼€æ‰‹ä¹‹åï¼Œä½ æƒ³ç»™ä»–å‘ä¸€ä¸ªè¡¨æƒ… ğŸ™„ï¸ï¼Œæ‰€ä»¥ä½ ç‚¹å‡»å¯¹è¯æ¡†è¾“å…¥ ğŸ™„ï¸ã€‚<br>å¦‚æœå‘è¯­éŸ³å’Œå¯¹è¯æ¡†è¾“å…¥å¿…é¡»æŒ‰ç…§é¡ºåºè¿›è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸¤ä¸ªåŠ¨ä½œå¿…é¡»æŒ‰é¡ºåºèµ°ï¼Œé‚£ä¹ˆä¸‡ä¸€ä½ æ‰€å¤„ç¯å¢ƒç½‘ç»œçŠ¶æ€å¾ˆå·®ï¼Œä½ å°±éœ€è¦ç­‰è¿™ 60 ç§’è¯­éŸ³å®Œå…¨ç”¨æ¸£ç½‘ç»œå‘å®Œä¹‹åï¼Œä½ æ‰èƒ½å¤Ÿç‚¹å¾—åŠ¨å¯¹è¯æ¡†æ¥è¾“å…¥ã€‚æˆ‘ç›¸ä¿¡è¿™ä¸ªæ—¶å€™ä½ å·²ç»æŠŠæ‰‹æœºç ¸äº†â€¦</p>
<p><strong><code>4</code> æ‰€ä»¥å‘¢â€¦</strong></p>
<p>æ‰€ä»¥ï¼Œè¿™å°±æ˜¯å¤šçº¿ç¨‹çš„å¿…è¦æ€§å•Šâ€¦</p>
<p><br></p>
<h2 id="ä¸²è¡Œã€å¹¶è¡Œå’Œå¹¶å‘"><a href="#ä¸²è¡Œã€å¹¶è¡Œå’Œå¹¶å‘" class="headerlink" title="ä¸²è¡Œã€å¹¶è¡Œå’Œå¹¶å‘"></a>ä¸²è¡Œã€å¹¶è¡Œå’Œå¹¶å‘</h2><hr>
<p><strong><code>1</code>ä¸²è¡Œæ˜¯ä»€ä¹ˆ</strong></p>
<p>ä¸²è¡Œæ˜¯æŒ‡åœ¨åŒä¸€æ—¶é—´ç‚¹ï¼Œåªæ‰§è¡Œä¸€ä¸ªä»»åŠ¡ã€‚æ¯”å¦‚åªæœ‰ä¸€ä¸ª CPUï¼Œåªèƒ½è·‘ä¸€æ¡çº¿ç¨‹ã€‚</p>
<p><strong><code>2</code> å¹¶è¡Œæ˜¯ä»€ä¹ˆ</strong></p>
<p>å¹¶è¡Œæ˜¯æŒ‡åœ¨åŒä¸€æ—¶é—´ç‚¹ï¼ŒåŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚æ¯”å¦‚æœ‰ä¸¤ä¸ª CPUï¼Œå¯ä»¥åŒæ—¶è·‘ä¸¤æ¡çº¿ç¨‹ã€‚</p>
<p><strong><code>3</code> å¹¶å‘æ˜¯ä»€ä¹ˆ</strong></p>
<p>å¹¶å‘æ˜¯æŒ‡åœ¨åŒä¸€æ—¶é—´ç‚¹ï¼Œæœ‰æ‰§è¡Œå¤šä¸ªä»»åŠ¡çš„èƒ½åŠ›ã€‚æ¯”å¦‚åªæœ‰ä¸€ä¸ª CPUï¼Œä½†æ˜¯å¯ä»¥éå¸¸å¿«é€Ÿåœ°åœ¨ä¸¤æ¡çº¿ç¨‹ä¸Šåˆ‡æ¥åˆ‡å»ï¼Œçœ‹èµ·æ¥åƒæ˜¯åŒæ—¶è·‘ä¸¤æ¡çº¿ç¨‹ã€‚</p>
<p><strong><code>4</code> ç”¨äººè¯æ¥è¯´</strong></p>
<p>å†°é›ªæ¶ˆèï¼Œä¸‡ç‰©å¤è‹ï¼Œæ˜¥å¤©æ¥äº†ï¼Œåˆåˆ°äº†æ’¸ä¸²çš„æ—¶å€™ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°è€æ¿æŠŠ 1 å—ç¾Šè‚‰ç©¿è¿›ä¸²ï¼Œå†æŠŠ 1 å—è½¯éª¨ç©¿è¿›ä¸²ï¼Œæ¥ç€æ˜¯ 1 å—å½©æ¤’â€¦ å¾ªç¯ 1â€¦8 æ¬¡ï¼Œè¿”å› 2 ä¸²éª¨è‚‰ç›¸è¿ã€‚è¿™æ˜¯ä¸²è¡Œã€‚</p>
<p>åˆåŒåˆ°äº†æ’¸ä¸²çš„æ—¶å€™ï¼Œæ¯”è¾ƒç‰›é€¼çš„è€æ¿æ‰‹é‡Œå¯ä»¥æ‹¿ 2 æ ¹ç­¾å­ï¼ŒåŒæ—¶ä¸² 2 å—ç¾Šè‚‰ï¼Œå†æ˜¯ 2 å—è½¯éª¨ï¼Œæ¥ç€ 2 å—å½©æ¤’â€¦ å¾ªç¯ 1â€¦4 æ¬¡ï¼Œè¿”å› 2 ä¸²éª¨å¤´ç›¸è¿ã€‚è¿™æ˜¯å¹¶è¡Œã€‚</p>
<p>åˆåŒå’æ˜¯æ’¸ä¸²çš„æ—¶å€™ï¼Œå‘ç°è€æ¿ä¸€æ‰‹æ¡èµ·ä¸¤ä¸ªç­¾å­â€¦ å¤§æ¦‚æ˜¯è¿™æ · â€”ğŸ‘Šâ€”</p>
<p>ç„¶åï¼Œç©¿ 1 å—ç¾Šè‚‰ï¼Œå”°ï¼Œæ‰‹éå¸¸å¿«é€Ÿåœ°è½¬åˆ°å¦ä¸€å¤´ï¼Œç©¿ 1 å—ç¾Šè‚‰ï¼Œå”°ï¼Œæ‰‹åˆéå¸¸å¿«é€Ÿåœ°(ğŸ™„ï¸)è½¬åˆ°å¦ä¸€å¤´â€¦ å¾ªç¯ 1â€¦4 æ¬¡ï¼Œè¿”å› 2 ä¸²éª¨è‚‰ç›¸è¿ã€‚è¿™æ˜¯å¹¶å‘ã€‚</p>
<p><br></p>
<h2 id="åŒæ­¥å’Œå¼‚æ­¥"><a href="#åŒæ­¥å’Œå¼‚æ­¥" class="headerlink" title="åŒæ­¥å’Œå¼‚æ­¥"></a>åŒæ­¥å’Œå¼‚æ­¥</h2><hr>
<p><strong><code>1</code> åŒæ­¥æ˜¯ä»€ä¹ˆ</strong></p>
<p>åŒæ­¥æ–¹æ³•æ˜¯å®Œæˆä»»åŠ¡ä¹‹åè¿”å›ï¼Œæ§åˆ¶æƒäº¤å›ç»™æ–¹æ³•è°ƒç”¨è€…ï¼ŒåŒæ—¶ç»™ç»“æœã€‚</p>
<p><strong><code>2</code> å¼‚æ­¥æ˜¯ä»€ä¹ˆ</strong></p>
<p>å¼‚æ­¥æ–¹æ³•æ˜¯ä»»åŠ¡å¼€å§‹å°±ç«‹å³è¿”å›ï¼Œæ§åˆ¶æƒé©¬ä¸Šå›å½’æ–¹æ³•è°ƒç”¨è€…ï¼Œç»“æœåœ¨éœ€è¦æ—¶ç”±æŒæƒè€…å»æ‹¿ã€‚</p>
<p><strong><code>3</code> äººè¯</strong></p>
<p>åŒæ­¥å°±æ˜¯æˆ‘ç»™ä½ ä¸€å¼ çº¸æ¡ï¼Œä¸Šé¢å†™ç€<code>ä¹° 7 æ¯å†°ç¾å¼ç»™æˆ‘</code>ï¼Œä½ æŠŠçº¸æ¡æ‹¿å»ï¼Œä¹°äº† 7 æ¯å†°ç¾å¼å›æ¥ï¼ŒåŒæ—¶æŠŠçº¸æ¡è¿˜ç»™æˆ‘ã€‚</p>
<p>å¼‚æ­¥å°±æ˜¯æˆ‘ç»™ä½ ä¸€å¼ çº¸æ¡ï¼Œä¸Šé¢å†™ç€<code>ä¹° 7 æ¯å†°ç¾å¼æ”¾åˆ°å‰å°</code>ï¼Œä½ çœ‹å®ŒæŠŠçº¸æ¡è¿˜ç»™æˆ‘ï¼Œä¹°äº† 7 æ¯å†°ç¾å¼æ”¾åˆ°äº†å‰å°ï¼Œæˆ‘éœ€è¦çš„æ—¶å€™å†å»å‰å°æ‹¿ã€‚</p>
<p><br></p>
<h2 id="é˜Ÿåˆ—"><a href="#é˜Ÿåˆ—" class="headerlink" title="é˜Ÿåˆ—"></a>é˜Ÿåˆ—</h2><hr>
<p><strong><code>1</code> é¡ºåºé˜Ÿåˆ—</strong></p>
<p>- - - <code>ä»»åŠ¡1</code> <code>æˆ‘æ˜¯ä»»åŠ¡2</code> <code>æˆ‘ä»»åŠ¡3</code> - - -</p>
<p><strong><code>2</code> å¹¶å‘é˜Ÿåˆ—</strong></p>
<p>- - -<code>ä»»åŠ¡1</code>- - - - - - - - - - - - - - - - - - - - -</p>
<p>- - - - - - - -<code>æˆ‘æ˜¯ä»»åŠ¡2</code> - - - - - - - - - - - -</p>
<p>- - - - - - - - - - - -<code>æˆ‘ä»»åŠ¡3</code>- - - - - - - - - -</p>
<p><br></p>
<h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><hr>
<p><strong><code>1</code> ä¸´ç•ŒåŒº</strong></p>
<p>ä¸èƒ½å¹¶å‘æ‰§è¡Œçš„ä»£ç ã€‚æ¯”å¦‚è¯´ä½ å£è¢‹é‡Œæœ‰ 1 ä¸ªç¡¬å¸ï¼Œå·¦æ‰‹çŸ¥é“æœ‰ 1 ä¸ªç¡¬å¸æ‰€ä»¥æƒ³æ‹¿ 1 ä¸ªï¼ŒåŒæ—¶å³æ‰‹ä¹ŸçŸ¥é“æœ‰ 1 ä¸ªç¡¬å¸ä¹Ÿæƒ³æ‹¿ 1 ä¸ªã€‚å¦‚æœå·¦æ‰‹æ‹¿äº† 1 ä¸ªï¼Œå³æ‰‹å°±æ²¡å¾—æ‹¿ï¼Œä½†å®ƒåˆæ˜¯è¢«å‘ŠçŸ¥å£è¢‹é‡Œæœ‰ 1 ä¸ªç¡¬å¸ï¼Œç„¶åå°±ä¸€ç›´æ‰¾ä¸€ç›´æ‰¾ï¼Œæœ€åï¼Œå³æ‰‹å’ã€‚åä¹‹ï¼Œå·¦æ‰‹å’ã€‚</p>
<p><strong><code>2</code> çº¿ç¨‹å®‰å…¨</strong></p>
<p>èƒ½å¤Ÿå¹¶å‘æ‰§è¡Œæˆ–è€…å¤šä¸ªçº¿ç¨‹åŒæ—¶è°ƒç”¨çš„ä»£ç ã€‚æ¯”å¦‚è¯´ä½ å£è¢‹é‡Œæœ‰ 1 ä¸ªç¡¬å¸ï¼Œä¸èƒ½æ‹¿åªèƒ½æ‘¸(â€¦)ï¼Œå·¦æ‰‹æƒ³æ‘¸ 1 ä¸ªç¡¬å¸ï¼ŒåŒæ—¶å³æ‰‹ä¹Ÿæƒ³æ‘¸ 1 ä¸ªç¡¬å¸ï¼Œç„¶åå®ƒä»¬éƒ½æ‘¸åˆ°äº†â€¦</p>
<p><strong><code>3</code> äº’æ–¥é”</strong></p>
<p>ç»™ä¸´ç•ŒåŒºåŠ é”ï¼Œä¿è¯ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ã€‚</p>
<p><strong><code>4</code> æ­»é”</strong></p>
<p>ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹ï¼Œå› ä¸ºè¦ç­‰å¾…å½¼æ­¤ä»»åŠ¡çš„å®Œæˆè€Œé™·å…¥åŒæ–¹æˆ–å¤šæ–¹å‡ä¸èƒ½ç»§ç»­è¿›è¡Œçš„å›°å¢ƒã€‚ä¹Ÿå°±æ˜¯ç»å¸¸åœ¨äº¤å‰è·¯å£å››è¾†è½¦äº’ä¸é€€è®©çš„æƒ…å†µã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;å…³äºå¤šçº¿ç¨‹éœ€è¦ç†è§£çš„ä¸€äº›åŸºæœ¬çš„æ¦‚å¿µï¼Œä¸ºäº†é˜²æ­¢æ‰“ä»£ç æ‰“åˆ°é˜¿å°”å…¹æµ·é»˜ç—‡ï¼Œå†™ä¸‹å‡ ä¸ªæŠ–æœºçµçš„ ğŸŒ° â€¦&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;
    
    </summary>
    
    
      <category term="iOS å¤šçº¿ç¨‹" scheme="https://zhengbuxuan.github.io/tags/iOS-%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://zhengbuxuan.github.io/2017/08/27/hello-world/"/>
    <id>https://zhengbuxuan.github.io/2017/08/27/hello-world/</id>
    <published>2017-08-27T15:00:23.000Z</published>
    <updated>2017-08-27T15:00:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>iOS å¤šçº¿ç¨‹ NSThread Swift 3</title>
    <link href="https://zhengbuxuan.github.io/2017/08/27/iOS%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B9%8B%20NSThread/"/>
    <id>https://zhengbuxuan.github.io/2017/08/27/iOS å¤šçº¿ç¨‹ä¹‹ NSThread/</id>
    <published>2017-08-27T14:30:00.000Z</published>
    <updated>2017-08-29T14:39:37.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0-å‰è¨€"><a href="#0-å‰è¨€" class="headerlink" title="0. å‰è¨€"></a>0. å‰è¨€</h2><p>NSThread æ˜¯ iOS å¤šçº¿ç¨‹å½“ä¸­æœ€åŸºç¡€æœ€è½»é‡çš„å¤šçº¿ç¨‹æŠ€æœ¯ï¼Œä½†æ˜¯éœ€è¦è‡ªè¡Œç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå’ŒåŒæ­¥é—®é¢˜ï¼Œæ‰€ä»¥ä½¿ç”¨èµ·æ¥å…¶å®æ¯”è¾ƒéº»çƒ¦ã€‚<br>åœ¨ Swift 3 ä¸­ï¼Œ<strong>NSThread</strong> å·²ç»è¢«é‡å‘½åä¸º <strong>Thread</strong>ï¼Œå¾ˆå¤šçš„æ–¹æ³•åä¹Ÿè¿›è¡Œäº†ä¿®æ”¹ã€‚<br>ä¸‹é¢å°±å†™ä¸€ä¸‹è‡ªå·±å­¦åˆ°çš„ä¸œè¥¿ï¼Œå½“ä½œå­¦ä¹ ç¬”è®°ï¼Œä»¥åå¯ä»¥ç¿»çœ‹ã€‚å¦‚æœæœ‰é”™è¯¯çš„åœ°æ–¹æœ›æŒ‡æ­£ã€‚</p>
<h2 id="1-åˆ›å»ºçº¿ç¨‹å’Œè·å–çº¿ç¨‹"><a href="#1-åˆ›å»ºçº¿ç¨‹å’Œè·å–çº¿ç¨‹" class="headerlink" title="1. åˆ›å»ºçº¿ç¨‹å’Œè·å–çº¿ç¨‹"></a>1. åˆ›å»ºçº¿ç¨‹å’Œè·å–çº¿ç¨‹</h2><ul>
<li>ç›´æ¥åˆ›å»ºçº¿ç¨‹æ˜¯æœ€åŸºæœ¬çš„åˆ›å»ºæ–¹å¼ï¼Œ<strong>å¯ä»¥è·å–åˆ°çº¿ç¨‹çº¿ç¨‹å¯¹è±¡</strong>ï¼Œé€‚åˆéœ€è¦å¯¹çº¿ç¨‹å¯¹è±¡è¿›è¡Œæ“ä½œçš„æƒ…å†µã€‚éœ€è¦<strong>æ‰‹åŠ¨å¯åŠ¨</strong>ã€‚</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ç›´æ¥åˆ›å»º</span></div><div class="line"><span class="keyword">let</span> thread = <span class="type">Thread</span>.<span class="keyword">init</span>(target: <span class="keyword">self</span>, selector: <span class="type">Selector</span>(<span class="string">"run"</span>), object: <span class="literal">nil</span>)</div><div class="line">thread.name = <span class="string">"firstThread"</span></div><div class="line">thread.start()</div></pre></td></tr></table></figure>
<ul>
<li>åˆ†ç¦»å­çº¿ç¨‹ï¼Œ<strong>ä¸èƒ½è·å–åˆ°çº¿ç¨‹å¯¹è±¡</strong>ï¼Œåˆ›å»ºä¹‹å<strong>è‡ªå¯åŠ¨</strong>ã€‚</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åˆ†ç¦»å­çº¿ç¨‹</span></div><div class="line"><span class="type">Thread</span>.detachNewThreadSelector(<span class="type">Selector</span>(<span class="string">"run"</span>), toTarget: <span class="keyword">self</span>, with: <span class="literal">nil</span>)</div></pre></td></tr></table></figure>
<ul>
<li>å¼€å¯ä¸€æ¡åå°çº¿ç¨‹ï¼ŒåŒæ ·<strong>ä¸èƒ½è·å–åˆ°çº¿ç¨‹å¯¹è±¡</strong>ï¼Œåˆ›å»ºå<strong>è‡ªå¯åŠ¨</strong>ã€‚</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åå°çº¿ç¨‹</span></div><div class="line"><span class="keyword">self</span>.performSelector(inBackground: <span class="type">Selector</span>(<span class="string">"run"</span>), with: <span class="literal">nil</span>)</div></pre></td></tr></table></figure>
<ul>
<li>è‡ªå®šä¹‰çº¿ç¨‹ç±»ç»§æ‰¿è‡ªThreadï¼Œå¯¹å†…éƒ¨çš„æ–¹æ³•è¿›è¡Œé‡å†™å°è£…ï¼Œæ»¡è¶³è‡ªå®šä¹‰éœ€æ±‚ã€‚</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è‡ªå®šä¹‰çº¿ç¨‹</span></div><div class="line"><span class="keyword">let</span> customThread = <span class="type">CustomThread</span>()</div><div class="line">customThread.start()</div></pre></td></tr></table></figure>
<ul>
<li>è·å–çº¿ç¨‹</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è·å–ä¸»çº¿ç¨‹</span></div><div class="line"><span class="keyword">let</span> mainThread = <span class="type">Thread</span>.main</div><div class="line"></div><div class="line"><span class="comment">//è·å–å½“å‰çº¿ç¨‹</span></div><div class="line"><span class="keyword">let</span> currentThread = <span class="type">Thread</span>.current</div><div class="line"></div><div class="line"><span class="comment">//åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦ä¸ºä¸»çº¿ç¨‹ è¿”å›ç±»å‹ä¸ºBool</span></div><div class="line"><span class="keyword">let</span> currentIsMain = <span class="type">Thread</span>.isMainThread</div></pre></td></tr></table></figure>
<h2 id="2-çº¿ç¨‹çŠ¶æ€"><a href="#2-çº¿ç¨‹çŠ¶æ€" class="headerlink" title="2. çº¿ç¨‹çŠ¶æ€"></a>2. çº¿ç¨‹çŠ¶æ€</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//é€€å‡ºçº¿ç¨‹</span></div><div class="line"><span class="type">Thread</span>.exit()</div><div class="line"></div><div class="line"><span class="comment">//çº¿ç¨‹ä¼‘çœ ç»™å®šæ—¶é—´</span></div><div class="line"><span class="type">Thread</span>.sleep(forTimeInterval: <span class="number">1.0</span>)</div><div class="line"></div><div class="line"><span class="comment">//çº¿ç¨‹ä¼‘çœ è‡³ç‰¹å®šæ—¶é—´</span></div><div class="line"><span class="type">Thread</span>.sleep(until: <span class="type">Date</span>(timeIntervalSinceNow: <span class="number">1.0</span>))</div></pre></td></tr></table></figure>
<h2 id="3-çº¿ç¨‹åŒæ­¥ä¸åŠ é”"><a href="#3-çº¿ç¨‹åŒæ­¥ä¸åŠ é”" class="headerlink" title="3. çº¿ç¨‹åŒæ­¥ä¸åŠ é”"></a>3. çº¿ç¨‹åŒæ­¥ä¸åŠ é”</h2><p>å…³äºåŒæ­¥å’ŒåŠ é”ï¼Œæ˜¯å¤šçº¿ç¨‹é€ƒä¸æ‰çš„è¯é¢˜ã€‚Thread ä¸­çš„çº¿ç¨‹åŒæ­¥ä¸€èˆ¬ç”¨ NSCondition æ¥åŠ é”å®ç°ã€‚NSCondition(è¿™ä¸ªæ²¡æœ‰æ”¹åå­—â€¦)ä¸»è¦ä½¿ç”¨çš„æ˜¯ lock()ã€wait() å’Œ unlock()ã€‚<br>è‹¹æœçš„ API æ–‡æ¡£æ˜¯è¿™ä¹ˆæè¿° NSCondition çš„ï¼š</p>
<blockquote>
<p>The NSCondition class implements a condition variable whose semantics follow those used for POSIX-style conditions.<br>A condition object acts as both a lock and a checkpoint in a given thread.</p>
</blockquote>
<p>æ„æ€å°±æ˜¯ NSCondition æ‰€æè¿°çš„æ¡ä»¶å¯¹è±¡åœ¨çº¿ç¨‹å½“ä¸­åŒæ—¶æ‰®æ¼”é”(lock)å’Œæ£€æŸ¥ç‚¹(checkpoint)çš„è§’è‰²ã€‚</p>
<blockquote>
<p>The lock protects your code while it tests the condition and performs the task triggered by the condition.<br>The checkpoint behavior requires that the condition be true before the thread proceeds with its task.<br>While the condition is not true, the thread blocks. It remains blocked until another thread signals the condition object.</p>
</blockquote>
<p>Lock ä¿æŠ¤ç€ä½ â€¦â€¦ çš„ä»£ç ï¼Œä»¥ä¿è¯å®ƒä»¬èƒ½æŒ‰ç…§é€»è¾‘æ¥è¿è¡Œå’Œæ»¡è¶³æ¡ä»¶æ—¶çš„è§¦å‘æ‰§è¡Œã€‚<br>çº¿ç¨‹è¦å¹²æ´»çš„æ—¶å€™éœ€è¦ checkpoint çš„æ¡ä»¶ä¸ºçœŸï¼Œä¸ç„¶å°±é˜»å¡ç½¢å·¥ï¼Œç›´åˆ°å…¶å®ƒçº¿ç¨‹ç»™å®ƒå‘ä¿¡å·å”¤é†’å®ƒã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ª ğŸŒ°<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span> : <span class="title">UIViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//å£°æ˜ä¸¤ä¸ªçº¿ç¨‹</span></div><div class="line">    <span class="keyword">var</span> thread_1: <span class="type">Thread</span>?</div><div class="line">    <span class="keyword">var</span> thread_2: <span class="type">Thread</span>?</div><div class="line"></div><div class="line">    <span class="comment">//åˆ›å»ºä¸¤ä¸ª NSCondition</span></div><div class="line">    <span class="keyword">let</span> condition_1 = <span class="type">NSCondition</span>()</div><div class="line">    <span class="keyword">let</span> condition_2 = <span class="type">NSCondition</span>()</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line">        <span class="comment">//ä¸¤ä¸ªçº¿ç¨‹çš„åˆ›å»ºå’Œ thread_1 çš„å¯åŠ¨</span></div><div class="line">        thread_1 = <span class="type">Thread</span>(target: <span class="keyword">self</span>, selector: #selector(<span class="keyword">self</span>.forThreadOne) , object: <span class="literal">nil</span>)</div><div class="line">        thread_2 = <span class="type">Thread</span>(target: <span class="keyword">self</span>, selector: #selector(<span class="keyword">self</span>.forThreadTwo), object: <span class="literal">nil</span>)</div><div class="line">        thread_1?.start()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//thread_1 éœ€è¦æ‰§è¡Œçš„æ–¹æ³•</span></div><div class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">forThreadOne</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">7</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"Thread_1 is running for the #<span class="subst">\(i)</span> time(s)."</span>)</div><div class="line">            <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span> &#123;</div><div class="line">                <span class="comment">//åˆ¤æ–­ thread_2 æ˜¯å¦åœ¨è¿è¡Œä¸­ï¼Œæ²¡è¿è¡Œå°±å¯åŠ¨ï¼Œå¦‚æœåœ¨è¿è¡Œå°±å‘ä¿¡å·å”¤é†’ thread_2</span></div><div class="line">                <span class="keyword">if</span> thread_2!.isExecuting &#123;</div><div class="line">                    condition_2.signal()</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    thread_2?.start()</div><div class="line">                &#125;</div><div class="line">                <span class="comment">//é”ä½ thread_1</span></div><div class="line">                condition_1.lock()</div><div class="line">                condition_1.wait()</div><div class="line">                condition_1.unlock()</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"Thread_1 says it is ended."</span>)</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//thread_2 éœ€è¦æ‰§è¡Œçš„æ–¹æ³•</span></div><div class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">forThreadTwo</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">7</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"Thread_2 is running for the #<span class="subst">\(i)</span> time(s)."</span>)</div><div class="line">            <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span> &#123;</div><div class="line">                <span class="comment">//å‘ä¿¡å·å”¤é†’ thread_1</span></div><div class="line">                condition_1.signal()</div><div class="line">                <span class="comment">//é”ä½ thread_2</span></div><div class="line">                condition_2.lock()</div><div class="line">                condition_2.wait()</div><div class="line">                condition_2.unlock()</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"Thread_2 says it is over."</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">didReceiveMemoryWarning</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.didReceiveMemoryWarning()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Swift è¿˜å¯ä»¥ä½¿ç”¨ objc_sync_enter(obj: Any!) å’Œ objc_sync_exit(obj: Any!) æ¥åŠ äº’æ–¥é”ï¼ŒäºŒè€…å¿…é¡»æˆå¯¹ä½¿ç”¨ï¼ŒæŠŠéœ€è¦åŠ é”çš„ä»£ç æ”¾åœ¨å®ƒä»¬ä¸¤ä¸ªä¸­é—´ã€‚<br>æ¯”å¦‚ä¸¾ä¸€ä¸ªä¹° 7 æœ¬ä¹¦çš„ ğŸŒ°<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> amountOfBooks = <span class="number">7</span></div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">run</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</div><div class="line">        objc_sync_enter(<span class="keyword">self</span>)</div><div class="line">        <span class="keyword">let</span> current = amountOfBooks</div><div class="line">        <span class="keyword">if</span> current &gt; <span class="number">0</span> &#123;</div><div class="line">            amountOfBooks = current - <span class="number">1</span></div><div class="line">            <span class="built_in">print</span>(...)</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="built_in">print</span>(...)</div><div class="line">            <span class="keyword">break</span></div><div class="line">        &#125;</div><div class="line">        objc_sync_exit(<span class="keyword">self</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>é¢˜å¤–è¯</strong><br>Swift éœ€è¦æˆå¯¹ä½¿ç”¨çš„æ–¹æ³•å¾ˆå¤šï¼Œå¤šåˆ°å¯ä»¥å†™ä¸€ä¸ªæ€»ç»“â€¦â€¦ å…ˆæŒ–ä¸ªå‘</p>
</blockquote>
<h2 id="4-çº¿ç¨‹é€šä¿¡"><a href="#4-çº¿ç¨‹é€šä¿¡" class="headerlink" title="4. çº¿ç¨‹é€šä¿¡"></a>4. çº¿ç¨‹é€šä¿¡</h2><p>ä¸»è¦æ¶‰åŠåˆ°çš„æ–¹æ³•æœ‰ä¸‰ä¸ªï¼Œå½“å‰çº¿ç¨‹çš„ã€ä¸»çº¿ç¨‹çš„ã€æŒ‡å®šçº¿ç¨‹çš„ã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å½“å‰çº¿ç¨‹</span></div><div class="line"><span class="keyword">self</span>.perform(#selector(<span class="keyword">self</span>.run), with: <span class="literal">nil</span>)</div><div class="line"></div><div class="line"><span class="comment">//ä¸»çº¿ç¨‹</span></div><div class="line"><span class="keyword">self</span>.performSelector(onMainThread: #selector(<span class="keyword">self</span>.run), with: <span class="literal">nil</span>, waitUntilDone: <span class="literal">true</span>)</div><div class="line"></div><div class="line"><span class="comment">//æŒ‡å®šçº¿ç¨‹</span></div><div class="line"><span class="keyword">self</span>.perform(#selector(<span class="keyword">self</span>.run), on: anotherThread, with: <span class="literal">nil</span>, waitUntilDone: <span class="literal">true</span>)</div></pre></td></tr></table></figure></p>
<p>ä¸¾ä¸€ä¸ªéå¸¸ç®€å•çš„å° ğŸŒ°ï¼Œåœ¨æŸä¸ª ViewControllerçš„viewDidLoad é‡Œï¼Œå¼€å¯äº†ä¸€ä¸ªå­çº¿ç¨‹ï¼Œè¿è¡Œ createNumber() æ–¹æ³•ï¼Œå£°æ˜ number å¹¶èµ‹å€¼ 7ã€‚<br>å®Œäº†ä»¥åï¼Œä½¿ç”¨ performSelector(onMainThread:â€¦) åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹ï¼Œå¹¶ä¸”è·‘èµ· printNumber() æ–¹æ³•ï¼ŒæŠŠ number ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚<br>å®Œæˆç®€å•çš„çº¿ç¨‹é—´é€šä¿¡ä¼ å€¼ã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span> : <span class="title">UIViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line">        <span class="type">Thread</span>.detachNewThreadSelector(#selector(<span class="keyword">self</span>.createNumber), toTarget: <span class="keyword">self</span>, with: <span class="literal">nil</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">createNumber</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">let</span> number = <span class="number">7</span></div><div class="line">        <span class="built_in">print</span>(<span class="string">"Current Thread: <span class="subst">\(Thread.current)</span>"</span>)</div><div class="line">        <span class="keyword">self</span>.performSelector(onMainThread: #selector(<span class="keyword">self</span>.printNumber(number:)), with: number, waitUntilDone: <span class="literal">true</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">printNumber</span><span class="params">(number: Int)</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"The number is: <span class="subst">\(number)</span>."</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">didReceiveMemoryWarning</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.didReceiveMemoryWarning()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>é¢˜å¤–è¯ x 2</strong><br>#selector(@objc method) æ˜¯éå¸¸ä¸ Swift 3 çš„å†™æ³•ï¼Œè¦æ±‚ä¼ å…¥çš„æ˜¯ä¸€ä¸ª @objc çš„æ–¹æ³•ã€‚<br>ä½¿ç”¨ Selector(â€œmethodWithoutParameterâ€) æˆ–è€… Selector(â€œmethodWithParameter:â€) çš„è¯å°±ä¸ç”¨åœ¨æ–¹æ³•å‰åŠ  @objc æ ‡ç­¾ï¼Œä½†æ˜¯ä¼šçˆ†é»„â€¦â€¦</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;0-å‰è¨€&quot;&gt;&lt;a href=&quot;#0-å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;0. å‰è¨€&quot;&gt;&lt;/a&gt;0. å‰è¨€&lt;/h2&gt;&lt;p&gt;NSThread æ˜¯ iOS å¤šçº¿ç¨‹å½“ä¸­æœ€åŸºç¡€æœ€è½»é‡çš„å¤šçº¿ç¨‹æŠ€æœ¯ï¼Œä½†æ˜¯éœ€è¦è‡ªè¡Œç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå’ŒåŒæ­¥é—®é¢˜ï¼Œæ‰€ä»¥ä½¿ç”¨èµ·æ¥
    
    </summary>
    
    
      <category term="iOS å¤šçº¿ç¨‹" scheme="https://zhengbuxuan.github.io/tags/iOS-%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>iOS å¤šçº¿ç¨‹ä¹‹ NSOperation (Swift)</title>
    <link href="https://zhengbuxuan.github.io/2017/08/27/iOS%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B9%8B%20NSOperation/"/>
    <id>https://zhengbuxuan.github.io/2017/08/27/iOS å¤šçº¿ç¨‹ä¹‹ NSOperation/</id>
    <published>2017-08-27T12:52:15.000Z</published>
    <updated>2017-09-02T13:35:45.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0-å‰è¨€"><a href="#0-å‰è¨€" class="headerlink" title="0. å‰è¨€"></a>0. å‰è¨€</h2><p>NSOperation æ˜¯è‹¹æœåœ¨ GCD ä¸Šçš„å°è£…ï¼ŒNSOperation ç›¸å¯¹äº GCD è€Œè¨€ï¼Œåœ¨å¤„ç†æ•°é‡è¾ƒå¤§çš„å¹¶å‘æ—¶æ¯”è¾ƒç‰›é€¼ä¸€ç‚¹ï¼Œä½†æ˜¯é€Ÿåº¦ç¨å¾®æ¯” GCD æ…¢ä¸€ä¸¢ä¸¢ã€‚<br><strong>NSOperation</strong> ç°åœ¨åœ¨ Swift é‡Œå·²ç»è¢«æ”¹åæˆäº† <strong>Operation</strong>ã€‚<br>Operation å°†çº¿ç¨‹çš„ç®¡ç†å’Œæ•°æ®çš„åŒæ­¥é—®é¢˜å®Œæˆäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æŠŠæˆ‘ä»¬æƒ³è¦å¹²çš„äº‹æƒ…æå¥½å°±å¯ä»¥äº†ã€‚</p>
<hr>
<h2 id="1-ä½¿ç”¨-Operation"><a href="#1-ä½¿ç”¨-Operation" class="headerlink" title="1. ä½¿ç”¨ Operation"></a>1. ä½¿ç”¨ Operation</h2><p>Operation æ˜¯ä¸€ä¸ª <strong>æŠ½è±¡ç±»</strong> ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œè¦ä¸å°± <strong>å†™ä¸€ä¸ªå­ç±»</strong> æ¥å®ç°å®ƒï¼Œè¦ä¸å°±ç”¨å®ƒå·²ç» <strong>å®šä¹‰å¥½çš„å­ç±»</strong> ã€‚è¿™ä¸ªæ—¶å€™ä¼šæ¥è§¦åˆ°ä¸€ä¸ªå« <strong>OperationQueue</strong> çš„é˜Ÿåˆ—ï¼Œéœ€è¦æˆ‘ä»¬åˆ›å»ºå¥½ Operation çš„å¯¹è±¡ä¹‹åï¼ŒæŠŠè¿™ä¸ªå¯¹è±¡ä¸¢åˆ° OperationQueue é‡Œé¢å»æ‰§è¡Œã€‚</p>
<h4 id="å®šä¹‰å¥½çš„å­ç±»"><a href="#å®šä¹‰å¥½çš„å­ç±»" class="headerlink" title="å®šä¹‰å¥½çš„å­ç±»"></a>å®šä¹‰å¥½çš„å­ç±»</h4><p>Operation é‡Œé¢è‡ªå¸¦çš„ä¸€ä¸ªå­ç±»å« BlockOperationã€‚çœ‹åˆ° <strong>block</strong> å°±çŸ¥é“è¿™ä¸ªä¸œè¥¿åˆæ˜¯ä» Objective-C æè¿‡æ¥çš„â€¦<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span> : <span class="title">UIViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line"></div><div class="line">        <span class="keyword">let</span> blockOperation = <span class="type">BlockOperation</span>(block: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] <span class="keyword">in</span></div><div class="line">            <span class="keyword">self</span>?.printMessage()</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;)</div><div class="line"></div><div class="line">        <span class="keyword">let</span> operationQueue = <span class="type">OperationQueue</span>()</div><div class="line">        operationQueue.addOperation(blockOperation)</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printMessage</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"I'm BlockOperation."</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="è‡ªå·±å†™çš„å­ç±»"><a href="#è‡ªå·±å†™çš„å­ç±»" class="headerlink" title="è‡ªå·±å†™çš„å­ç±»"></a>è‡ªå·±å†™çš„å­ç±»</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span> : <span class="title">UIViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line"></div><div class="line">        <span class="keyword">let</span> customizeOperation = customizeOperation()</div><div class="line"></div><div class="line">        <span class="keyword">let</span> operationQueue = <span class="type">OperationQueue</span>()</div><div class="line">        operationQueue.addOperation(customizeOperation)</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomizeOperation</span>: <span class="title">Operation</span> </span>&#123;</div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"I'm CustomizeOperation!"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="2-åŸºç¡€æ“ä½œ"><a href="#2-åŸºç¡€æ“ä½œ" class="headerlink" title="2. åŸºç¡€æ“ä½œ"></a>2. åŸºç¡€æ“ä½œ</h2><h4 id="Operation-æ·»åŠ "><a href="#Operation-æ·»åŠ " class="headerlink" title="Operation æ·»åŠ "></a>Operation æ·»åŠ </h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">operationQueue.addOperation(anOperationToAdd)</div></pre></td></tr></table></figure>
<h4 id="Operation-å›è°ƒ"><a href="#Operation-å›è°ƒ" class="headerlink" title="Operation å›è°ƒ"></a>Operation å›è°ƒ</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è¿™ä¸ªæ—¶å€™åˆä¼šçœ‹åˆ°é‡‘å…‰é—ªé—ªçš„ä¸€ä¸ª block ...</span></div><div class="line"><span class="comment">// å›è°ƒå°±æ˜¯åœ¨ Operation å®Œæˆä¹‹åå¤§å–Šä¸€å£° â€œæˆ‘å®Œäº‹å„¿äº†â€ è¡¨ç¤ºä»»åŠ¡ç»“æŸ...</span></div><div class="line">operation.completionBlock = &#123; () -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line">        <span class="built_in">print</span>(<span class="string">"I'm done!"</span>)</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h4 id="Operation-ä¾èµ–"><a href="#Operation-ä¾èµ–" class="headerlink" title="Operation ä¾èµ–"></a>Operation ä¾èµ–</h4><p>å‡å¦‚è¯´æœ‰å¥½å‡ ä¸ª Operation çš„å¯¹è±¡ï¼Œå½“å®ƒä»¬éœ€è¦æŒ‰ç…§ä¸€å®šçš„é¡ºåºæ‰§è¡Œï¼Œæˆ–è€…è¯´å®ƒä»¬çš„å·¥ä½œå†…å®¹éœ€è¦å…¶ä»– Operation çš„ç»“æœçš„æ—¶å€™ï¼Œå°±éœ€è¦ç»™ Operation é—´æ·»åŠ ä¾èµ–å…³ç³»ã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> operation1 = <span class="type">BlockOperation</span> &#123;</div><div class="line">    <span class="comment">// I will do my job when operation2 is completed.</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> operation2 = <span class="type">BlockOperation</span> &#123;</div><div class="line">    <span class="comment">// I'm gonna do my job so that operation1 can do its job.</span></div><div class="line">&#125;</div><div class="line"><span class="comment">// operation1 ä¾èµ–äº operation2</span></div><div class="line">operation1.addDependency(operation2)</div><div class="line"><span class="comment">// é˜Ÿåˆ—åˆ›å»ºå’Œæ“ä½œæ·»åŠ ï¼Œæ·»åŠ é¡ºåºæ— æ‰€è°“</span></div><div class="line"><span class="keyword">let</span> dependencyQueue = <span class="type">OperationQueue</span>()</div><div class="line">dependencyQueue.addOperation(operation1)</div><div class="line">dependencyQueue.addOperation(operation2)</div></pre></td></tr></table></figure></p>
<h4 id="Operation-å–æ¶ˆ"><a href="#Operation-å–æ¶ˆ" class="headerlink" title="Operation å–æ¶ˆ"></a>Operation å–æ¶ˆ</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å–æ¶ˆé˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ Operation æ“ä½œ</span></div><div class="line">operationQueue.cancelAllOperation()</div></pre></td></tr></table></figure>
<h4 id="OperationQueue-å¹¶å‘ä¸Šé™è®¾ç½®"><a href="#OperationQueue-å¹¶å‘ä¸Šé™è®¾ç½®" class="headerlink" title="OperationQueue å¹¶å‘ä¸Šé™è®¾ç½®"></a>OperationQueue å¹¶å‘ä¸Šé™è®¾ç½®</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è®¾ç½®æœ€å¤§å¹¶å‘æ“ä½œæ•°ä¸º 7 ï¼Œé»˜è®¤ä¸º -1 è¡¨ç¤ºæ— é™åˆ¶</span></div><div class="line">operationQueue.maxConcurrentOperationCount = <span class="number">7</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;0-å‰è¨€&quot;&gt;&lt;a href=&quot;#0-å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;0. å‰è¨€&quot;&gt;&lt;/a&gt;0. å‰è¨€&lt;/h2&gt;&lt;p&gt;NSOperation æ˜¯è‹¹æœåœ¨ GCD ä¸Šçš„å°è£…ï¼ŒNSOperation ç›¸å¯¹äº GCD è€Œè¨€ï¼Œåœ¨å¤„ç†æ•°é‡è¾ƒå¤§çš„å¹¶å‘æ—¶
    
    </summary>
    
    
      <category term="iOS å¤šçº¿ç¨‹" scheme="https://zhengbuxuan.github.io/tags/iOS-%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
</feed>
