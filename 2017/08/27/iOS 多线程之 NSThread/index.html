<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> iOS å¤šçº¿ç¨‹ NSThread Swift 3 Â· Hexo</title><meta name="description" content="iOS å¤šçº¿ç¨‹ NSThread Swift 3 - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://zhengbuxuan.github.io/atom.xml" title="Hexo"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/zhengbuxuan" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/zhengbuxuan" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">iOS å¤šçº¿ç¨‹ NSThread Swift 3</h1><div class="post-info">Aug 27, 2017</div><div class="post-content"><h2 id="0-å‰è¨€"><a href="#0-å‰è¨€" class="headerlink" title="0. å‰è¨€"></a>0. å‰è¨€</h2><p>NSThread æ˜¯ iOS å¤šçº¿ç¨‹å½“ä¸­æœ€åŸºç¡€æœ€è½»é‡çš„å¤šçº¿ç¨‹æŠ€æœ¯ï¼Œä½†æ˜¯éœ€è¦è‡ªè¡Œç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå’ŒåŒæ­¥é—®é¢˜ï¼Œæ‰€ä»¥ä½¿ç”¨èµ·æ¥å…¶å®æ¯”è¾ƒéº»çƒ¦ã€‚<br>åœ¨ Swift 3 ä¸­ï¼Œ<strong>NSThread</strong> å·²ç»è¢«é‡å‘½åä¸º <strong>Thread</strong>ï¼Œå¾ˆå¤šçš„æ–¹æ³•åä¹Ÿè¿›è¡Œäº†ä¿®æ”¹ã€‚<br>ä¸‹é¢å°±å†™ä¸€ä¸‹è‡ªå·±å­¦åˆ°çš„ä¸œè¥¿ï¼Œå½“ä½œå­¦ä¹ ç¬”è®°ï¼Œä»¥åå¯ä»¥ç¿»çœ‹ã€‚å¦‚æœæœ‰é”™è¯¯çš„åœ°æ–¹æœ›æŒ‡æ­£ã€‚</p>
<h2 id="1-åˆ›å»ºçº¿ç¨‹å’Œè·å–çº¿ç¨‹"><a href="#1-åˆ›å»ºçº¿ç¨‹å’Œè·å–çº¿ç¨‹" class="headerlink" title="1. åˆ›å»ºçº¿ç¨‹å’Œè·å–çº¿ç¨‹"></a>1. åˆ›å»ºçº¿ç¨‹å’Œè·å–çº¿ç¨‹</h2><ul>
<li>ç›´æ¥åˆ›å»ºçº¿ç¨‹æ˜¯æœ€åŸºæœ¬çš„åˆ›å»ºæ–¹å¼ï¼Œ<strong>å¯ä»¥è·å–åˆ°çº¿ç¨‹çº¿ç¨‹å¯¹è±¡</strong>ï¼Œé€‚åˆéœ€è¦å¯¹çº¿ç¨‹å¯¹è±¡è¿›è¡Œæ“ä½œçš„æƒ…å†µã€‚éœ€è¦<strong>æ‰‹åŠ¨å¯åŠ¨</strong>ã€‚</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ç›´æ¥åˆ›å»º</span></div><div class="line"><span class="keyword">let</span> thread = <span class="type">Thread</span>.<span class="keyword">init</span>(target: <span class="keyword">self</span>, selector: <span class="type">Selector</span>(<span class="string">"run"</span>), object: <span class="literal">nil</span>)</div><div class="line">thread.name = <span class="string">"firstThread"</span></div><div class="line">thread.start()</div></pre></td></tr></table></figure>
<ul>
<li>åˆ†ç¦»å­çº¿ç¨‹ï¼Œ<strong>ä¸èƒ½è·å–åˆ°çº¿ç¨‹å¯¹è±¡</strong>ï¼Œåˆ›å»ºä¹‹å<strong>è‡ªå¯åŠ¨</strong>ã€‚</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åˆ†ç¦»å­çº¿ç¨‹</span></div><div class="line"><span class="type">Thread</span>.detachNewThreadSelector(<span class="type">Selector</span>(<span class="string">"run"</span>), toTarget: <span class="keyword">self</span>, with: <span class="literal">nil</span>)</div></pre></td></tr></table></figure>
<ul>
<li>å¼€å¯ä¸€æ¡åå°çº¿ç¨‹ï¼ŒåŒæ ·<strong>ä¸èƒ½è·å–åˆ°çº¿ç¨‹å¯¹è±¡</strong>ï¼Œåˆ›å»ºå<strong>è‡ªå¯åŠ¨</strong>ã€‚</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åå°çº¿ç¨‹</span></div><div class="line"><span class="keyword">self</span>.performSelector(inBackground: <span class="type">Selector</span>(<span class="string">"run"</span>), with: <span class="literal">nil</span>)</div></pre></td></tr></table></figure>
<ul>
<li>è‡ªå®šä¹‰çº¿ç¨‹ç±»ç»§æ‰¿è‡ªThreadï¼Œå¯¹å†…éƒ¨çš„æ–¹æ³•è¿›è¡Œé‡å†™å°è£…ï¼Œæ»¡è¶³è‡ªå®šä¹‰éœ€æ±‚ã€‚</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è‡ªå®šä¹‰çº¿ç¨‹</span></div><div class="line"><span class="keyword">let</span> customThread = <span class="type">CustomThread</span>()</div><div class="line">customThread.start()</div></pre></td></tr></table></figure>
<ul>
<li>è·å–çº¿ç¨‹</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è·å–ä¸»çº¿ç¨‹</span></div><div class="line"><span class="keyword">let</span> mainThread = <span class="type">Thread</span>.main</div><div class="line"></div><div class="line"><span class="comment">//è·å–å½“å‰çº¿ç¨‹</span></div><div class="line"><span class="keyword">let</span> currentThread = <span class="type">Thread</span>.current</div><div class="line"></div><div class="line"><span class="comment">//åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦ä¸ºä¸»çº¿ç¨‹ è¿”å›ç±»å‹ä¸ºBool</span></div><div class="line"><span class="keyword">let</span> currentIsMain = <span class="type">Thread</span>.isMainThread</div></pre></td></tr></table></figure>
<h2 id="2-çº¿ç¨‹çŠ¶æ€"><a href="#2-çº¿ç¨‹çŠ¶æ€" class="headerlink" title="2. çº¿ç¨‹çŠ¶æ€"></a>2. çº¿ç¨‹çŠ¶æ€</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//é€€å‡ºçº¿ç¨‹</span></div><div class="line"><span class="type">Thread</span>.exit()</div><div class="line"></div><div class="line"><span class="comment">//çº¿ç¨‹ä¼‘çœ ç»™å®šæ—¶é—´</span></div><div class="line"><span class="type">Thread</span>.sleep(forTimeInterval: <span class="number">1.0</span>)</div><div class="line"></div><div class="line"><span class="comment">//çº¿ç¨‹ä¼‘çœ è‡³ç‰¹å®šæ—¶é—´</span></div><div class="line"><span class="type">Thread</span>.sleep(until: <span class="type">Date</span>(timeIntervalSinceNow: <span class="number">1.0</span>))</div></pre></td></tr></table></figure>
<h2 id="3-çº¿ç¨‹åŒæ­¥ä¸åŠ é”"><a href="#3-çº¿ç¨‹åŒæ­¥ä¸åŠ é”" class="headerlink" title="3. çº¿ç¨‹åŒæ­¥ä¸åŠ é”"></a>3. çº¿ç¨‹åŒæ­¥ä¸åŠ é”</h2><p>å…³äºåŒæ­¥å’ŒåŠ é”ï¼Œæ˜¯å¤šçº¿ç¨‹é€ƒä¸æ‰çš„è¯é¢˜ã€‚Thread ä¸­çš„çº¿ç¨‹åŒæ­¥ä¸€èˆ¬ç”¨ NSCondition æ¥åŠ é”å®ç°ã€‚NSCondition(è¿™ä¸ªæ²¡æœ‰æ”¹åå­—â€¦)ä¸»è¦ä½¿ç”¨çš„æ˜¯ lock()ã€wait() å’Œ unlock()ã€‚<br>è‹¹æœçš„ API æ–‡æ¡£æ˜¯è¿™ä¹ˆæè¿° NSCondition çš„ï¼š</p>
<blockquote>
<p>The NSCondition class implements a condition variable whose semantics follow those used for POSIX-style conditions.<br>A condition object acts as both a lock and a checkpoint in a given thread.</p>
</blockquote>
<p>æ„æ€å°±æ˜¯ NSCondition æ‰€æè¿°çš„æ¡ä»¶å¯¹è±¡åœ¨çº¿ç¨‹å½“ä¸­åŒæ—¶æ‰®æ¼”é”(lock)å’Œæ£€æŸ¥ç‚¹(checkpoint)çš„è§’è‰²ã€‚</p>
<blockquote>
<p>The lock protects your code while it tests the condition and performs the task triggered by the condition.<br>The checkpoint behavior requires that the condition be true before the thread proceeds with its task.<br>While the condition is not true, the thread blocks. It remains blocked until another thread signals the condition object.</p>
</blockquote>
<p>Lock ä¿æŠ¤ç€ä½ â€¦â€¦ çš„ä»£ç ï¼Œä»¥ä¿è¯å®ƒä»¬èƒ½æŒ‰ç…§é€»è¾‘æ¥è¿è¡Œå’Œæ»¡è¶³æ¡ä»¶æ—¶çš„è§¦å‘æ‰§è¡Œã€‚<br>çº¿ç¨‹è¦å¹²æ´»çš„æ—¶å€™éœ€è¦ checkpoint çš„æ¡ä»¶ä¸ºçœŸï¼Œä¸ç„¶å°±é˜»å¡ç½¢å·¥ï¼Œç›´åˆ°å…¶å®ƒçº¿ç¨‹ç»™å®ƒå‘ä¿¡å·å”¤é†’å®ƒã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ª ğŸŒ°<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span> : <span class="title">UIViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//å£°æ˜ä¸¤ä¸ªçº¿ç¨‹</span></div><div class="line">    <span class="keyword">var</span> thread_1: <span class="type">Thread</span>?</div><div class="line">    <span class="keyword">var</span> thread_2: <span class="type">Thread</span>?</div><div class="line"></div><div class="line">    <span class="comment">//åˆ›å»ºä¸¤ä¸ª NSCondition</span></div><div class="line">    <span class="keyword">let</span> condition_1 = <span class="type">NSCondition</span>()</div><div class="line">    <span class="keyword">let</span> condition_2 = <span class="type">NSCondition</span>()</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line">        <span class="comment">//ä¸¤ä¸ªçº¿ç¨‹çš„åˆ›å»ºå’Œ thread_1 çš„å¯åŠ¨</span></div><div class="line">        thread_1 = <span class="type">Thread</span>(target: <span class="keyword">self</span>, selector: #selector(<span class="keyword">self</span>.forThreadOne) , object: <span class="literal">nil</span>)</div><div class="line">        thread_2 = <span class="type">Thread</span>(target: <span class="keyword">self</span>, selector: #selector(<span class="keyword">self</span>.forThreadTwo), object: <span class="literal">nil</span>)</div><div class="line">        thread_1?.start()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//thread_1 éœ€è¦æ‰§è¡Œçš„æ–¹æ³•</span></div><div class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">forThreadOne</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">7</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"Thread_1 is running for the #<span class="subst">\(i)</span> time(s)."</span>)</div><div class="line">            <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span> &#123;</div><div class="line">                <span class="comment">//åˆ¤æ–­ thread_2 æ˜¯å¦åœ¨è¿è¡Œä¸­ï¼Œæ²¡è¿è¡Œå°±å¯åŠ¨ï¼Œå¦‚æœåœ¨è¿è¡Œå°±å‘ä¿¡å·å”¤é†’ thread_2</span></div><div class="line">                <span class="keyword">if</span> thread_2!.isExecuting &#123;</div><div class="line">                    condition_2.signal()</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    thread_2?.start()</div><div class="line">                &#125;</div><div class="line">                <span class="comment">//é”ä½ thread_1</span></div><div class="line">                condition_1.lock()</div><div class="line">                condition_1.wait()</div><div class="line">                condition_1.unlock()</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"Thread_1 says it is ended."</span>)</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//thread_2 éœ€è¦æ‰§è¡Œçš„æ–¹æ³•</span></div><div class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">forThreadTwo</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">7</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"Thread_2 is running for the #<span class="subst">\(i)</span> time(s)."</span>)</div><div class="line">            <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span> &#123;</div><div class="line">                <span class="comment">//å‘ä¿¡å·å”¤é†’ thread_1</span></div><div class="line">                condition_1.signal()</div><div class="line">                <span class="comment">//é”ä½ thread_2</span></div><div class="line">                condition_2.lock()</div><div class="line">                condition_2.wait()</div><div class="line">                condition_2.unlock()</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"Thread_2 says it is over."</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">didReceiveMemoryWarning</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.didReceiveMemoryWarning()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Swift è¿˜å¯ä»¥ä½¿ç”¨ objc_sync_enter(obj: Any!) å’Œ objc_sync_exit(obj: Any!) æ¥åŠ äº’æ–¥é”ï¼ŒäºŒè€…å¿…é¡»æˆå¯¹ä½¿ç”¨ï¼ŒæŠŠéœ€è¦åŠ é”çš„ä»£ç æ”¾åœ¨å®ƒä»¬ä¸¤ä¸ªä¸­é—´ã€‚<br>æ¯”å¦‚ä¸¾ä¸€ä¸ªä¹° 7 æœ¬ä¹¦çš„ ğŸŒ°<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> amountOfBooks = <span class="number">7</span></div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">run</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</div><div class="line">        objc_sync_enter(<span class="keyword">self</span>)</div><div class="line">        <span class="keyword">let</span> current = amountOfBooks</div><div class="line">        <span class="keyword">if</span> current &gt; <span class="number">0</span> &#123;</div><div class="line">            amountOfBooks = current - <span class="number">1</span></div><div class="line">            <span class="built_in">print</span>(...)</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="built_in">print</span>(...)</div><div class="line">            <span class="keyword">break</span></div><div class="line">        &#125;</div><div class="line">        objc_sync_exit(<span class="keyword">self</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>é¢˜å¤–è¯</strong><br>Swift éœ€è¦æˆå¯¹ä½¿ç”¨çš„æ–¹æ³•å¾ˆå¤šï¼Œå¤šåˆ°å¯ä»¥å†™ä¸€ä¸ªæ€»ç»“â€¦â€¦ å…ˆæŒ–ä¸ªå‘</p>
</blockquote>
<h2 id="4-çº¿ç¨‹é€šä¿¡"><a href="#4-çº¿ç¨‹é€šä¿¡" class="headerlink" title="4. çº¿ç¨‹é€šä¿¡"></a>4. çº¿ç¨‹é€šä¿¡</h2><p>ä¸»è¦æ¶‰åŠåˆ°çš„æ–¹æ³•æœ‰ä¸‰ä¸ªï¼Œå½“å‰çº¿ç¨‹çš„ã€ä¸»çº¿ç¨‹çš„ã€æŒ‡å®šçº¿ç¨‹çš„ã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å½“å‰çº¿ç¨‹</span></div><div class="line"><span class="keyword">self</span>.perform(#selector(<span class="keyword">self</span>.run), with: <span class="literal">nil</span>)</div><div class="line"></div><div class="line"><span class="comment">//ä¸»çº¿ç¨‹</span></div><div class="line"><span class="keyword">self</span>.performSelector(onMainThread: #selector(<span class="keyword">self</span>.run), with: <span class="literal">nil</span>, waitUntilDone: <span class="literal">true</span>)</div><div class="line"></div><div class="line"><span class="comment">//æŒ‡å®šçº¿ç¨‹</span></div><div class="line"><span class="keyword">self</span>.perform(#selector(<span class="keyword">self</span>.run), on: anotherThread, with: <span class="literal">nil</span>, waitUntilDone: <span class="literal">true</span>)</div></pre></td></tr></table></figure></p>
<p>ä¸¾ä¸€ä¸ªéå¸¸ç®€å•çš„å° ğŸŒ°ï¼Œåœ¨æŸä¸ª ViewControllerçš„viewDidLoad é‡Œï¼Œå¼€å¯äº†ä¸€ä¸ªå­çº¿ç¨‹ï¼Œè¿è¡Œ createNumber() æ–¹æ³•ï¼Œå£°æ˜ number å¹¶èµ‹å€¼ 7ã€‚<br>å®Œäº†ä»¥åï¼Œä½¿ç”¨ performSelector(onMainThread:â€¦) åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹ï¼Œå¹¶ä¸”è·‘èµ· printNumber() æ–¹æ³•ï¼ŒæŠŠ number ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚<br>å®Œæˆç®€å•çš„çº¿ç¨‹é—´é€šä¿¡ä¼ å€¼ã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span> : <span class="title">UIViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line">        <span class="type">Thread</span>.detachNewThreadSelector(#selector(<span class="keyword">self</span>.createNumber), toTarget: <span class="keyword">self</span>, with: <span class="literal">nil</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">createNumber</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">let</span> number = <span class="number">7</span></div><div class="line">        <span class="built_in">print</span>(<span class="string">"Current Thread: <span class="subst">\(Thread.current)</span>"</span>)</div><div class="line">        <span class="keyword">self</span>.performSelector(onMainThread: #selector(<span class="keyword">self</span>.printNumber(number:)), with: number, waitUntilDone: <span class="literal">true</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">printNumber</span><span class="params">(number: Int)</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"The number is: <span class="subst">\(number)</span>."</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">didReceiveMemoryWarning</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.didReceiveMemoryWarning()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>é¢˜å¤–è¯ x 2</strong><br>#selector(@objc method) æ˜¯éå¸¸ä¸ Swift 3 çš„å†™æ³•ï¼Œè¦æ±‚ä¼ å…¥çš„æ˜¯ä¸€ä¸ª @objc çš„æ–¹æ³•ã€‚<br>ä½¿ç”¨ Selector(â€œmethodWithoutParameterâ€) æˆ–è€… Selector(â€œmethodWithParameter:â€) çš„è¯å°±ä¸ç”¨åœ¨æ–¹æ³•å‰åŠ  @objc æ ‡ç­¾ï¼Œä½†æ˜¯ä¼šçˆ†é»„â€¦â€¦</p>
</blockquote>
</div></article></div></main><footer><div class="paginator"><a href="/2017/08/27/hello-world/" class="prev">PREV</a><a href="/2017/08/27/iOS å¤šçº¿ç¨‹ä¹‹ NSOperation/" class="next">NEXT</a></div><div class="copyright"><p>Â© 2015 - 2017 <a href="https://zhengbuxuan.github.io">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>